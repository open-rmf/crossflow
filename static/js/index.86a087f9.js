(()=>{"use strict";var e={1569:function(){},4773:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>g});var o=n(4381),i=n(1164),a=n(9849),s=n(813),l=n(3749),u=n(9426),d=n(4069),c=n(2854),p=n(3943),f=n(4187),h=n(6500),y=e([c,p]);[c,p]=y.then?(await y)():y;let b=(0,i.ZP)(a.Z)({justifyContent:"flex-start"});function m(e,t,n,r){return"scope"===r.type?(0,p.Ac)(e,t,n,r,(0,u.Z)()).map(e=>({type:"add",item:e})):[{type:"add",item:(0,p.ou)(e,t,n,r,(0,u.Z)())}]}let g=function(e){let{parentId:t,newNodePosition:n,onAdd:r}=e,[i]=(0,d.Xz)(),a=(0,c.zQ)(),u=l.useMemo(()=>{let e=t&&a.tryGetNode(t);return e&&(0,p.on)(e)?(0,f.Tz)(e.data.namespace,e.data.opId):f.He},[t,a]);return(0,o.jsxs)(s.Z,{orientation:"vertical",variant:"contained",size:"small","aria-label":"Add operation button group",children:[i.mode===d.je.Template&&u===f.He&&(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.G9,{}),onClick:()=>{var e;let t=(0,h.H)("new_input",a.nodes.filter(p.sw).map(e=>e.data.remappedId));null==r||r([(e={builtin:"dispose"},{type:"add",item:(0,p.nJ)(t,e,n)})])},children:"Section Input"}),i.mode===d.je.Template&&u===f.He&&(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.k_,{}),onClick:()=>{let e=(0,h.H)("new_output",a.nodes.filter(p.D5).map(e=>e.data.outputId));null==r||r([{type:"add",item:(0,p.kj)(e,n)}])},children:"Section Output"}),i.mode===d.je.Template&&u===f.He&&(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.hF,{}),onClick:()=>{var e;let t=(0,h.H)("new_buffer",a.nodes.filter(p.yZ).map(e=>e.data.remappedId));null==r||r([(e={builtin:"dispose"},{type:"add",item:(0,p.B0)(t,e,n)})])},children:"Section Buffer"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.qh,{}),onClick:()=>{null==r||r(m(u,t,n,{type:"node",builder:"",next:{builtin:"dispose"}}))},children:"Node"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.Vd,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"fork_clone",next:[]})),children:"Fork Clone"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.Cz,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"unzip",next:[]})),children:"Unzip"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.Hu,{}),onClick:()=>{null==r||r(m(u,t,n,{type:"fork_result",err:{builtin:"dispose"},ok:{builtin:"dispose"}}))},children:"Fork Result"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.kz,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"split"})),children:"Split"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.yQ,{}),onClick:()=>{null==r||r(m(u,t,n,{type:"join",buffers:[],next:{builtin:"dispose"}}))},children:"Join"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.dY,{}),onClick:()=>{null==r||r(m(u,t,n,{type:"transform",cel:"",next:{builtin:"dispose"}}))},children:"Transform"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.Es,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"buffer"})),children:"Buffer"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.Zt,{}),onClick:()=>{null==r||r(m(u,t,n,{type:"buffer_access",buffers:[],next:{builtin:"dispose"}}))},children:"Buffer Access"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.UM,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"listen",buffers:[],next:{builtin:"dispose"}})),children:"Listen"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.sI,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"stream_out",name:""})),children:"Stream Out"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.RR,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"scope",start:{builtin:"dispose"},ops:{},next:{builtin:"dispose"}})),children:"Scope"}),(0,o.jsx)(b,{startIcon:(0,o.jsx)(p.UD,{}),onClick:()=>null==r?void 0:r(m(u,t,n,{type:"section",template:""})),children:"Section"})]})};r()}catch(e){r(e)}})},6621:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{m:()=>l}),n(4381);var o=n(3749),i=n(4996),a=e([i]);i=(a.then?(await a)():a)[0];let s=(0,o.createContext)(new i.S),l=()=>(0,o.useContext)(s);r()}catch(e){r(e)}})},1493:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{S:()=>o.S});var o=n(7897),i=e([o]);o=(i.then?(await i)():i)[0],r()}catch(e){r(e)}})},5828:function(e,t,n){(0,n(5354).J)("DebugSessionMessage")},4996:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{S:()=>o.S});var o=n(1493);n(5828);var i=e([o]);o=(i.then?(await i)():i)[0],r()}catch(e){r(e)}})},7897:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{S:()=>d});var o=n(4697),i=n(9114),a=n(5354),s=n(3152),l=e([s]);s=(l.then?(await l)():l)[0];let u=(0,a.J)("DiagramElementRegistry");class d{getRegistry(){let e=s.Ff();if(!u(e))throw u.errors;return(0,o.of)(e)}postRunWorkflow(e,t){return(0,i.D)(s.ad(new s.hv({diagram:e,request:t})))}constructor(){s.wc()}}r()}catch(e){r(e)}})},2585:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>f});var o=n(4381);n(5585),n(9354),n(2989),n(2626),n(985);var i=n(1132),a=n(2518),s=n(5011);n(1569);var l=n(9847),u=n(7817),d=n(5065),c=e([u,l]);[u,l]=c.then?(await c)():c;let p=(0,i.Z)({palette:{mode:"dark"},cssVariables:!0}),f=()=>(0,o.jsxs)(a.Z,{theme:p,children:[(0,o.jsx)(s.ZP,{enableColorScheme:!0}),(0,o.jsx)("div",{style:{width:"100vw",height:"100vh"},children:(0,o.jsx)(u.g,{children:(0,o.jsx)(d.q,{children:(0,o.jsx)(l.Z,{})})})})]});r()}catch(e){r(e)}})},6917:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>h});var o=n(4381),i=n(7461),a=n(9849),s=n(3796),l=n(3749),u=n(3943),d=n(8322),c=n(6713),p=e([d,u]);[d,u]=p.then?(await p)():p;let f=e=>({nodes:e.nodes,edges:e.edges}),h=l.memo(function(e){let{onNodeChanges:t}=e,{nodes:n,edges:r}=(0,s.useStore)(f);return(0,o.jsx)(i.Z,{title:"Auto Layout",children:(0,o.jsx)(a.Z,{onClick:()=>{let e=(0,d.M)(n,r,c.O);t(e)},children:(0,o.jsx)(u.xk,{symbol:"dashboard"})})})});r()}catch(e){r(e)}})},2944:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>_});var o=n(4381),i=n(1164),a=n(3961),s=n(813),l=n(7461),u=n(9849),d=n(3796),c=n(3749),p=n(6917),f=n(5168),h=n(4069),y=n(3943),m=n(1913),b=n(7701),g=e([m,p,y,f,b]);[m,p,y,f,b]=g.then?(await g)():g;let x=(0,i.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),_=c.memo(function(e){let{onNodeChanges:t,onExportClick:n,onLoadDiagram:r}=e,i=(0,a.Z)(),[g,_]=c.useState(!1),[j,w]=c.useState(!0),[v]=(0,h.Xz)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.s_,{position:"top-center",children:(0,o.jsxs)(s.Z,{variant:"contained",children:[v.mode===h.je.Normal&&(0,o.jsx)(m.G,{requestJsonString:""}),v.mode===h.je.Normal&&(0,o.jsx)(l.Z,{title:"Diagram properties",children:(0,o.jsx)(u.Z,{onClick:()=>w(e=>!e),sx:j?{backgroundColor:i.palette.primary.light}:void 0,children:(0,o.jsx)(y.xk,{symbol:"info"})})}),v.mode===h.je.Normal&&(0,o.jsx)(l.Z,{title:"Templates",children:(0,o.jsx)(u.Z,{onClick:()=>_(!0),children:(0,o.jsx)(y.xk,{symbol:"architecture"})})}),(0,o.jsx)(p.Z,{onNodeChanges:t}),v.mode===h.je.Normal&&(0,o.jsx)(l.Z,{title:"Export Diagram",children:(0,o.jsx)(u.Z,{onClick:n,children:(0,o.jsx)(y.xk,{symbol:"download"})})}),v.mode===h.je.Normal&&(0,o.jsx)(l.Z,{title:"Load Diagram",children:(0,o.jsxs)(u.Z,{component:"label",role:void 0,children:[(0,o.jsx)(y.xk,{symbol:"upload_file"}),(0,o.jsx)(x,{type:"file",accept:"application/json","aria-label":"load diagram",onChange:async e=>{if(e.target.files){let t=await e.target.files[0].text();r(t,e.target.files[0].name)}},onClick:e=>{e.target.value=""}})]})})]})}),(0,o.jsx)(f.Z,{open:g,onClose:()=>_(!1)}),(0,o.jsx)(b.Z,{open:j,onClose:()=>w(!1)})]})});r()}catch(e){r(e)}})},9847:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>H});var o=n(4381),i=n(3961),a=n(2271),s=n(4790),l=n(7792),u=n(2682),d=n(570),c=n(5981),p=n(3796),f=n(7373),h=n(7948),y=n(3749),m=n(4773),b=n(2944),g=n(6113),x=n(4069),_=n(8684),j=n(6884),w=n(8463),v=n(4573),k=n(8182),Z=n(2854),O=n(3943),C=n(7817),S=n(5065),I=n(9526),$=n(8322),N=n(4163),T=n(2111),q=n(106),E=n(5785),D=n(6713),B=n(6066),P=e([Z,C,w,B,$,b,E,O,m,j,_]);[Z,C,w,B,$,b,E,O,m,j,_]=P.then?(await P)():P;let R=e=>{let{children:t}=e;return(0,o.jsx)(o.Fragment,{children:t})};function z(e){let{editorModeContext:t,loadContext:n,nodeManager:r,edges:i,diagramProperties:a,children:s}=e;return(0,o.jsx)(x.cb,{value:t,children:(0,o.jsx)(v.s,{value:n,children:(0,o.jsx)(Z.b,{value:r,children:(0,o.jsx)(I.w,{value:i,children:(0,o.jsx)(k.t,{value:a,children:s})})})})})}let H=function(){let e=y.useRef(null),[t,n]=y.useState({mode:x.je.Normal}),[r,v]=y.useState(()=>(0,B.DS)().nodes),k=y.useMemo(()=>new Z.Bl(r),[r]),I=y.useRef([]),[P,H]=y.useState([]),F=y.useRef([]),[M]=(0,S.z)(),A=(0,C.c)(),L=y.useCallback(t=>{var r,o;switch(t.mode){case x.je.Normal:v([...I.current]),H([...F.current]),null==(r=e.current)||r.fitView();break;case x.je.Template:{let n=M[t.templateId];if(!n)throw Error(`template ${t.templateId} not found`);let r=(0,B.$k)(n),i=(0,$.M)(r.nodes,r.edges,D.O);v(e=>(I.current=[...e],(0,p.Fb)(i,r.nodes))),H(e=>(F.current=[...e],r.edges)),null==(o=e.current)||o.fitView();break}default:throw(0,q.y)(t),Error("unknown editor mode")}n(t)},[M]),W=y.useCallback(e=>{H(t=>(0,p.yn)(e,t))},[]),K=y.useCallback(e=>{W([e])},[W]),[J,G]=(0,S.z)(),U=(0,i.Z)(),X=y.useMemo(()=>{switch(t.mode){case x.je.Normal:return U.palette.background.default;case x.je.Template:return(0,a._j)(U.palette.primary.main,.8);default:throw(0,q.y)(t),Error("unknown editor mode")}},[t,U]),V=y.useCallback(e=>{let t=[];for(let n of e){let e=function(e,t){switch(t.type){case"position":{let n=e.tryGetNode(t.id);if(!n)return null;return t.position?[t.id,n.parentId||null,t.position]:null}case"add":case"replace":return[t.item.id,t.item.parentId||null,t.item.position];default:return null}}(k,n);if(!e)continue;let[r,o,i]=e;if(!o)continue;let a=k.tryGetNode(o);if(!a)continue;let s=k.nodes.filter(e=>e.parentId===o&&e.id!==r),l=(0,D.e)([...s.map(e=>e.position),{x:Math.round(i.x),y:Math.round(i.y)}]),u={x:a.position.x,y:a.position.y,width:a.width??l.width,height:a.height??l.height};if((Math.abs(l.x)>D.O.scopePadding.leftRight||Math.abs(l.y)>D.O.scopePadding.topBottom||a.width&&Math.abs(l.width-a.width)>D.O.scopePadding.leftRight||a.height&&Math.abs(l.height-a.height)>D.O.scopePadding.topBottom)&&(u.x+=l.x,u.width=l.width,u.y+=l.y,u.height=l.height),u.x!==a.position.x||u.y!==a.position.y||u.width!==a.width||u.height!==a.height)for(let e of(t.push({type:"position",id:o,position:{x:u.x,y:u.y}}),t.push({type:"dimensions",id:o,dimensions:{width:u.width,height:u.height},setAttributes:!0}),s))t.push({type:"position",id:e.id,position:{x:e.position.x-l.x,y:e.position.y-l.y}})}let n=new Set(e.filter(e=>(0,N.t)(e)).map(e=>e.id));for(;;){let e=!1;for(let r of k.nodes)r.parentId&&n.has(r.parentId)&&!n.has(r.id)&&(t.push({type:"remove",id:r.id}),n.add(r.id),e=!0);if(!e)break}let r=[];for(let e of P)(n.has(e.source)||n.has(e.target))&&r.push({type:"remove",id:e.id});W(r),v(n=>(0,p.Fb)([...e,...t],n))},[W,k,P]),Y=y.useCallback(e=>{V([e])},[V]),[Q,ee]=y.useState({open:!1,popOverPosition:{left:0,top:0},parentId:null}),et=y.useMemo(()=>{var t;if(!e.current)return{x:0,y:0};let n=Q.parentId?k.tryGetNode(Q.parentId):null,r=(null==n?void 0:n.position)?n.position:{x:0,y:0};return(null==(t=e.current)?void 0:t.screenToFlowPosition({x:Q.popOverPosition.left-r.x,y:Q.popOverPosition.top-r.y}))||{x:0,y:0}},[k,Q.parentId,Q.popOverPosition]),[en,er]=y.useState(null),[eo,ei]=y.useState(null),ea=(()=>{if(!eo)return null;let e=P.find(e=>e.id===eo);if(!e)return console.error(`cannot find edge ${eo}`),null;let t=k.tryGetNode(e.source);if(!t)return console.error(`cannot find node ${e.source}`),null;let n=k.tryGetNode(e.target);return n?{edge:e,sourceNode:t,targetNode:n}:(console.error(`cannot find node ${e.target}`),null)})(),es=y.useCallback(()=>{er(null),ei(null),ee(e=>({...e,open:!1})),eu({open:!1})},[]),[el,eu]=y.useState({open:!1}),ed=y.useCallback(e=>{let t=k.tryGetNode(e);if(!t||(0,O.KC)(t))return null;let n=e=>{Y(e),es()};return"scope"===t.type?(0,o.jsx)(w.Z,{node:t,onChange:Y,onDelete:n,onAddOperationClick:e=>{ee({open:!0,popOverPosition:{left:e.clientX,top:e.clientY},parentId:t.id})}}):(0,o.jsx)(j.B6,{node:t,onChange:Y,onDelete:n},en)},[k,en,Y,es]),ec=y.useRef(0),[ep,ef]=y.useState(null),[eh,ey]=y.useState(!1),em=y.useCallback(e=>{ef(e),ey(!0)},[]),[eb,eg]=y.useState(null),[ex,e_]=y.useState({}),[ej,ew]=y.useState(null),ev=y.useCallback(async(t,n)=>{try{var r;let[o,{graph:i,isRestored:a}]=await (0,B.yO)(t);if(eg({diagram:o}),e_({description:o.description,input_examples:o.input_examples}),a)v(i.nodes);else{let e=(0,$.M)(i.nodes,i.edges,D.O);v((0,p.Fb)(e,i.nodes))}H(i.edges),G(o.templates||{}),ew(n),null==(r=e.current)||r.fitView(),es()}catch(e){em(`failed to load diagram: ${e}`)}},[es,em]),[ek,eZ]=y.useState(!1),eO=y.useCallback(()=>{ec.current=Date.now()},[]),eC=y.useCallback((e,t)=>{let n=k.tryGetNode(e.source),r=k.tryGetNode(e.target);if(!n||!r)throw Error("cannot find source or target node");let o=(0,T.M9)(n,e.sourceHandle,r,e.targetHandle);if(0===o.length)return em(`cannot connect "${n.type}" to "${r.type}"`),null;let i={...(0,g.Mt)(e.source,e.sourceHandle,e.target,e.targetHandle,t),type:o[0],data:(0,j.qV)(o[0])};"section"===r.type&&(g.Do[i.type]===g.Cn.Buffer?i.data.input={type:"sectionBuffer",inputId:""}:g.Do[i.type]===g.Cn.Data&&(i.data.input={type:"sectionInput",inputId:""}));let a=(0,T.b0)(i,k,P);return a.valid?i:(em(a.error),null)},[em,k,P]);return(0,o.jsx)(z,{editorModeContext:[t,L],loadContext:eb,nodeManager:k,edges:P,diagramProperties:ex,children:(0,o.jsxs)(p.x$,{nodes:r,edges:P,fitView:!0,fitViewOptions:{padding:.2},nodeTypes:O.kL,edgeTypes:g.ru,onInit:t=>{e.current=t;let n=new URLSearchParams(window.location.search).get("diagram");if(n)try{let e=atob(n),t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);let r=(0,h.T8)((0,h.n)(t));ev(r,null)}catch(e){if(e instanceof Error)em(`failed to load diagram: ${e.message}`);else throw e}},onNodesChange:V,onNodesDelete:()=>{es()},onEdgesChange:W,onEdgesDelete:()=>{es()},onConnect:e=>{let t=eC(e);t&&H(e=>(0,f.Z_)(t,e))},isValidConnection:e=>(0,T.oE)(e,k).valid,onReconnect:(e,t)=>{let n=eC(t,e.id);n&&(e.type=n.type,e.data=n.data,H(n=>(0,f.Kz)(e,t,n)))},onNodeClick:(e,t)=>{e.stopPropagation(),es(),(0,O.KC)(t)||(er(t.id),eu({open:!0,anchorReference:"anchorPosition",anchorPosition:{left:e.clientX,top:e.clientY}}))},onEdgeClick:(e,t)=>{e.stopPropagation(),es();let n=r.find(e=>e.id===t.source),o=r.find(e=>e.id===t.target);if(!n||!o)throw Error("unable to find source or target node");ei(t.id),eu({open:!0,anchorReference:"anchorPosition",anchorPosition:{left:e.clientX,top:e.clientY}})},onPaneClick:e=>{if(Q.open||el.open)return void es();Date.now()-ec.current>200||ee({open:!0,popOverPosition:{left:e.clientX,top:e.clientY},parentId:null})},onMouseDownCapture:eO,onTouchStartCapture:eO,colorMode:"dark",deleteKeyCode:"Delete",children:[(0,o.jsx)(p.Aq,{bgColor:X,color:(0,a.Fq)(U.palette.text.primary,.3),gap:30}),t.mode===x.je.Template&&(0,o.jsx)(p.s_,{position:"top-left",children:(0,o.jsx)(s.Z,{variant:"h4",children:t.templateId})}),(0,o.jsx)(b.Z,{onNodeChanges:V,onExportClick:y.useCallback(()=>eZ(!0),[]),onLoadDiagram:ev}),t.mode===x.je.Template&&(0,o.jsx)(l.Z,{color:"primary","aria-label":"Save",sx:{position:"absolute",right:64,bottom:64},onClick:()=>{let e=(0,E.W)(A,k,P);G(n=>({...n,[t.templateId]:e})),L({mode:x.je.Normal})},children:(0,o.jsx)(O.xk,{symbol:"check"})}),(0,o.jsx)(u.ZP,{open:Q.open,onClose:()=>ee(e=>({...e,open:!1})),anchorReference:"anchorPosition",anchorPosition:Q.popOverPosition,component:R,children:(0,o.jsx)(m.Z,{parentId:Q.parentId||void 0,newNodePosition:et,onAdd:e=>{V(e),es()}})}),(0,o.jsxs)(u.ZP,{...el,onClose:()=>eu({open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"left"},component:R,children:[en&&ed(en),ea&&(0,o.jsx)(j.tT,{edge:ea.edge,allowedEdgeTypes:(0,T.M9)(ea.sourceNode,ea.edge.sourceHandle,ea.targetNode,ea.edge.targetHandle),nodeManager:k,onChange:K,onDelete:e=>{H(t=>(0,p.yn)([e],t)),es()}},eo)]}),(0,o.jsx)(d.Z,{open:eh,onClose:(e,t)=>{"clickaway"!==t&&ey(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,o.jsx)(c.Z,{onClose:()=>ey(!1),severity:"error",children:ep})}),(0,o.jsx)(y.Suspense,{children:(0,o.jsx)(_.X,{open:ek,suggestedFilename:ej,onExportedFilename:e=>ew(e),onClose:()=>eZ(!1)})})]})})};r()}catch(e){r(e)}})},7701:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>N});var o=n(4381),i=n(3961),a=n(4993),s=n(8223),l=n(4790),u=n(7461),d=n(3023),c=n(707),p=n(3005),f=n(8355),h=n(3781),y=n(4903),m=n(5416),b=n(9265),g=n(5961),x=n(5088),_=n(1150),j=n(8694),w=n(9849),v=n(3943),k=n(3749),Z=n(8182),O=n(4573),C=n(1913),S=e([C,v]);[C,v]=S.then?(await S)():S;let I="20vw",$={description:"",value:void 0},N=function(e){let{open:t,onClose:n}=e,[r,S]=(0,Z.L)(),N=(0,O.e)(),T=(0,i.Z)(),[q,E]=k.useState("Copy this input example into clipboard"),[D,B]=k.useState(!1),[P,z]=k.useState($);k.useEffect(()=>{S({description:(null==N?void 0:N.diagram.description)??"",input_examples:(null==N?void 0:N.diagram.input_examples)??[]})},[N]);let R=k.useMemo(()=>""===P.description||void 0===P.value||""===P.value,[P]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.ZP,{sx:{width:I,flexShrink:0,"& .MuiDrawer-paper":{width:I}},variant:"persistent",anchor:"right",open:t,children:(0,o.jsxs)(s.Z,{spacing:2,sx:{m:2},children:[(0,o.jsxs)(s.Z,{direction:"row",children:[(0,o.jsxs)(s.Z,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[(0,o.jsx)(l.Z,{variant:"h6",children:"Description"}),(0,o.jsx)(u.Z,{title:"General description of what this diagram achieves, as well as any other relevant information that may help a user understand its execution.",children:(0,o.jsx)(v.xk,{symbol:"info",fontSize:"large"})})]}),(0,o.jsx)(s.Z,{direction:"row",sx:{marginLeft:"auto"},children:(0,o.jsx)(u.Z,{title:"Hide this panel",children:(0,o.jsx)(d.Z,{onClick:n,children:(0,o.jsx)(v.xk,{symbol:"close"})})})})]}),(0,o.jsx)(c.Z,{fullWidth:!0,multiline:!0,rows:10,maxRows:10,variant:"outlined",value:(null==r?void 0:r.description)??"",slotProps:{htmlInput:{sx:{fontFamily:"monospace"}}},onChange:e=>S(t=>({...t,description:e.target.value})),sx:{backgroundColor:T.palette.background.paper}}),(0,o.jsx)(p.Z,{}),(0,o.jsxs)(s.Z,{direction:"row",children:[(0,o.jsxs)(s.Z,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[(0,o.jsx)(l.Z,{variant:"h6",children:"Input Examples"}),(0,o.jsx)(u.Z,{title:"Input examples that can be executed with this workflow",children:(0,o.jsx)(v.xk,{symbol:"info",fontSize:"large"})})]}),(0,o.jsx)(s.Z,{direction:"row",sx:{marginLeft:"auto"},children:(0,o.jsx)(u.Z,{title:"Add input example",children:(0,o.jsx)(d.Z,{onClick:()=>B(!0),children:(0,o.jsx)(v.xk,{symbol:"add"})})})})]}),(0,o.jsx)(f.Z,{children:(0,o.jsx)(h.Z,{children:r&&r.input_examples&&r.input_examples.length>0?r.input_examples.map((e,t)=>(0,o.jsx)(y.ZP,{children:(0,o.jsx)(c.Z,{id:"input-with-icon-textfield",fullWidth:!0,multiline:!0,variant:"outlined",value:e.value,rows:"6",slotProps:{htmlInput:{sx:{fontFamily:"monospace"}},input:{endAdornment:(0,o.jsx)(m.Z,{position:"end",children:(0,o.jsxs)(s.Z,{direction:"column",children:[(0,o.jsx)(u.Z,{title:e.description,children:(0,o.jsx)(d.Z,{children:(0,o.jsx)(v.xk,{symbol:"info",fontSize:"large"})})}),(0,o.jsx)(u.Z,{title:"Delete input example",children:(0,o.jsx)(d.Z,{onClick:()=>{S(e=>{let n=e.input_examples??[];return t>=n.length?e:{...e,input_examples:[...n.slice(0,t),...n.slice(t+1)]}})},children:(0,o.jsx)(v.xk,{symbol:"delete",fontSize:"large"})})}),(0,o.jsx)(u.Z,{title:q,children:(0,o.jsx)(d.Z,{onClick:async()=>{let t="string"==typeof e.value?e.value:JSON.stringify(e.value,null,2)||"";await navigator.clipboard.writeText(t),E("Copied into clipboard!"),setTimeout(()=>{E("Copy this input example")},3e3)},children:(0,o.jsx)(v.xk,{symbol:"content_copy",fontSize:"large"})})}),(0,o.jsx)(u.Z,{title:"Run diagram with this input example",children:(0,o.jsx)(C.G,{requestJsonString:e.value})})]})})}}})},t)):(0,o.jsx)(y.ZP,{sx:{textAlign:"center"},children:(0,o.jsx)(b.Z,{slotProps:{primary:{color:T.palette.text.disabled}},primary:"No input examples available"})})})})]})}),(0,o.jsxs)(g.Z,{onClose:()=>{B(!1),z($)},open:D,fullWidth:!0,maxWidth:"sm",keepMounted:!1,children:[(0,o.jsx)(x.Z,{children:"Add input example"}),(0,o.jsx)(p.Z,{}),(0,o.jsx)(_.Z,{children:(0,o.jsxs)(s.Z,{spacing:2,children:[(0,o.jsx)(l.Z,{variant:"body1",children:"Value"}),(0,o.jsx)(c.Z,{fullWidth:!0,multiline:!0,rows:6,variant:"outlined",value:P.value,onChange:e=>z(t=>({...t,value:e.target.value}))}),(0,o.jsx)(l.Z,{variant:"body1",children:"Description"}),(0,o.jsx)(c.Z,{fullWidth:!0,multiline:!0,rows:3,variant:"outlined",value:P.description,onChange:e=>z(t=>({...t,description:e.target.value}))})]})}),(0,o.jsx)(j.Z,{children:(0,o.jsx)(w.Z,{variant:"contained",onClick:()=>{S(e=>{let t=e.input_examples??[];return{...e,input_examples:[...t,P]}}),B(!1),z($)},startIcon:(0,o.jsx)(v.xk,{symbol:"add"}),disabled:R,children:"Add"})})]})]})};r()}catch(e){r(e)}})},8182:function(e,t,n){n.d(t,{L:()=>s,t:()=>a});var r=n(4381),o=n(3749);let i=(0,o.createContext)(null);function a(e){let{children:t}=e,[n,a]=(0,o.useState)({});return(0,r.jsx)(i.Provider,{value:[n,a],children:t})}let s=()=>{let e=(0,o.useContext)(i);if(!e)throw Error("useDiagramProperties must be used within a TemplatesProvider");return e}},6113:function(e,t,n){n.d(t,{Cn:()=>q,sN:()=>C,Mt:()=>_,ru:()=>T,fe:()=>N,gw:()=>k,uh:()=>j,j1:()=>v,lJ:()=>D,Do:()=>E,F9:()=>$,_w:()=>O,qj:()=>w,Io:()=>I,XE:()=>S,zk:()=>Z});var r,o,i=n(4381),a=n(3796),s=n(3749);let l=(0,s.memo)(e=>{let t=(()=>{switch(e.data.input.type){case"bufferKey":return e.data.input.key||"Select Key";case"bufferSeq":return e.data.input.seq.toString();case"sectionBuffer":return e.data.input.inputId||"Select Buffer"}})();return(0,i.jsx)(a.xC,{...e,label:t})}),u=(0,s.memo)(e=>(0,i.jsx)(a.xC,{...e,label:"sectionInput"===e.data.input.type?e.data.input.inputId||"Select Input":void 0})),d=(0,s.memo)(function(e){return(0,i.jsx)(a.xC,{...e,label:"error"})}),c=(0,s.memo)(function(e){return(0,i.jsx)(a.xC,{...e,label:"ok"})}),p=(0,s.memo)(e=>(0,i.jsx)(a.xC,{...e,label:e.data.output.output||"Select Output"})),f=(0,s.memo)(function(e){return(0,i.jsx)(a.xC,{...e,label:e.data.output.key.toString()})}),h=(0,s.memo)(function(e){return(0,i.jsx)(a.xC,{...e,label:"*"})}),y=(0,s.memo)(function(e){return(0,i.jsx)(a.xC,{...e,label:e.data.output.seq.toString()})}),m=(0,s.memo)(function(e){return(0,i.jsx)(a.xC,{...e,label:`stream: ${e.data.output.streamId}`})}),b=(0,s.memo)(function(e){return(0,i.jsx)(a.xC,{...e,label:e.data.output.seq.toString()})});var g=n(7373),x=n(9426);function _(e,t,n,r,o){return{id:o||(0,x.Z)(),source:e,sourceHandle:t,target:n,targetHandle:r,markerEnd:{type:g.QZ.ArrowClosed,width:20,height:20}}}function j(e,t,n,r,o){return{..._(e,t,n,r),type:"default",data:{output:{},input:o||{type:"default"}}}}function w(e,t,n,r,o){return{..._(e,t,n,r),type:"unzip",data:{output:o,input:{type:"default"}}}}function v(e,t,n,r){return{..._(e,t,n,r),type:"forkResultOk",data:{output:{},input:{type:"default"}}}}function k(e,t,n,r){return{..._(e,t,n,r),type:"forkResultErr",data:{output:{},input:{type:"default"}}}}function Z(e,t,n,r,o){return{..._(e,t,n,r),type:"splitKey",data:{output:o,input:{type:"default"}}}}function O(e,t,n,r,o){return{..._(e,t,n,r),type:"splitSeq",data:{output:o,input:{type:"default"}}}}function C(e,t,n,r){return{..._(e,t,n,r),type:"splitRemaining",data:{output:{},input:{type:"default"}}}}function S(e,t,n,r,o){return{..._(e,t,n,r),type:"buffer",data:{output:{},input:o}}}function I(e,t,n,r,o){return{..._(e,t,n,r),type:"streamOut",data:{output:o,input:{type:"default"}}}}function $(e,t,n,r,o){return{..._(e,t,n,r),type:"section",data:{output:o,input:{type:"default"}}}}var N=((r={})[r.Pull=0]="Pull",r[r.Clone=1]="Clone",r);let T={default:u,unzip:b,forkResultOk:c,forkResultErr:d,splitKey:f,splitSeq:y,splitRemaining:h,buffer:l,streamOut:m,section:p};var q=((o={})[o.Data=0]="Data",o[o.Buffer=1]="Buffer",o);let E={buffer:1,forkResultOk:0,forkResultErr:0,splitKey:0,splitSeq:0,splitRemaining:0,default:0,streamOut:0,unzip:0,section:0};function D(e){return 0===E[e.type]}},5168:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>Z});var o=n(4381),i=n(3961),a=n(5961),s=n(5088),l=n(1150),u=n(8355),d=n(3781),c=n(4903),p=n(8223),f=n(9265),h=n(707),y=n(813),m=n(9849),b=n(7461),g=n(3005),x=n(8694),_=n(3749),j=n(4069),w=n(3943),v=n(5065),k=e([w]);w=(k.then?(await k)():k)[0];let Z=function(e){let{open:t,onClose:n}=e,r=(0,i.Z)(),[k,Z]=(0,v.z)(),O=Object.keys(k),[C,S]=(0,j.Xz)(),[I,$]=_.useState(null),[N,T]=_.useState(""),q=_.useRef(null);_.useEffect(()=>{q.current&&I&&(q.current.focus(),I.selectAll&&q.current.select(),I.scrollTo&&q.current.scrollTo({behavior:"smooth"}))},[I]);let E=()=>{let e={};for(let[t,n]of Object.entries(k))t===(null==I?void 0:I.target)?e[N]=n:e[t]=n;$(null),T(""),Z(e)};return(0,o.jsxs)(a.Z,{open:t,onClose:n,fullWidth:!0,maxWidth:"sm",keepMounted:!1,children:[(0,o.jsx)(s.Z,{children:"Templates"}),(0,o.jsx)(l.Z,{children:(0,o.jsxs)(u.Z,{children:[(0,o.jsx)(d.Z,{disablePadding:!0,sx:{maxHeight:"24rem",overflow:"auto"},children:O.length>0?O.map(e=>(0,o.jsx)(c.ZP,{divider:!0,children:(0,o.jsxs)(p.Z,{direction:"row",alignItems:"center",width:"100%",height:"3em",children:[(null==I?void 0:I.target)===e?(0,o.jsx)(f.Z,{children:(0,o.jsx)("form",{onSubmit:E,children:(0,o.jsx)(h.Z,{size:"small",fullWidth:!0,value:N,onChange:e=>{T(e.target.value)},inputRef:q,onSubmit:E})})}):(0,o.jsx)(f.Z,{children:e}),(0,o.jsxs)(y.Z,{variant:"contained",children:[(null==I?void 0:I.target)===e?(0,o.jsx)(m.Z,{onClick:E,children:(0,o.jsx)(w.xk,{symbol:"check"})}):(0,o.jsx)(b.Z,{title:"Rename",children:(0,o.jsx)(m.Z,{onClick:()=>{$({target:e}),T(e)},children:(0,o.jsx)(w.xk,{symbol:"text_select_start"})})}),(0,o.jsx)(b.Z,{title:"Edit",children:(0,o.jsx)(m.Z,{onClick:()=>{S({mode:j.je.Template,templateId:e}),n()},children:(0,o.jsx)(w.xk,{symbol:"edit"})})}),(0,o.jsx)(b.Z,{title:"Delete",children:(0,o.jsx)(m.Z,{variant:"outlined",color:"error",onClick:()=>Z(t=>{let n={...t};return delete n[e],n}),children:(0,o.jsx)(w.xk,{symbol:"delete"})})})]})]})},e)):(0,o.jsx)(c.ZP,{divider:!0,children:(0,o.jsx)(f.Z,{slotProps:{primary:{color:r.palette.text.disabled}},children:"No templates available"})})}),(0,o.jsx)(g.Z,{}),(0,o.jsx)(c.ZP,{children:(0,o.jsx)(p.Z,{justifyContent:"center",width:"100%",children:(0,o.jsx)(m.Z,{onClick:()=>{let e="new_template",t=e,n=0;for(;t in k;)t=`${e}_${++n}`;T(t),Z(e=>({...e,[t]:{inputs:{},outputs:[],buffers:{},ops:{}}})),$({target:t,selectAll:!0,scrollTo:!0})},children:(0,o.jsx)(w.xk,{symbol:"add"})})})})]})}),(0,o.jsx)(x.Z,{children:(0,o.jsx)(m.Z,{onClick:n,children:"Close"})})]})};r()}catch(e){r(e)}})},4069:function(e,t,n){n.d(t,{Xz:()=>u,cb:()=>l,je:()=>a});var r,o=n(4381),i=n(3749),a=((r={})[r.Normal=0]="Normal",r[r.Template=1]="Template",r);let s=(0,i.createContext)(null);function l(e){let{value:t,children:n}=e;return(0,o.jsx)(s.Provider,{value:t,children:n})}function u(){let e=(0,i.useContext)(s);if(!e)throw Error("useEditorMode must be used within a EditorModeProvider");return e}},8684:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{X:()=>S});var o=n(4381),i=n(3961),a=n(5961),s=n(5088),l=n(1150),u=n(8223),d=n(4790),c=n(813),p=n(707),f=n(9849),h=n(8694),y=n(7948),m=n(3749),b=n(4573),g=n(2854),x=n(3943),_=n(6911),j=n(7817),w=n(5065),v=n(9526),k=n(5785),Z=n(8182),O=e([g,j,k,x]);function C(e){let{open:t,suggestedFilename:n,onExportedFilename:r,onClose:O}=e,C=(0,g.zQ)(),S=(0,v.M)(),[I]=(0,w.z)(),$=(0,j.c)(),N=(0,b.e)(),[T]=(0,Z.L)(),q=(0,i.Z)(),E=(0,m.useMemo)(async()=>{let e=(0,k.G)($,C,S,I,T??{});(null==N?void 0:N.diagram.extensions)&&(e.extensions=N.diagram.extensions),await (0,_.z)(e,{nodes:[...C.nodes],edges:[...S]});let t=JSON.stringify(e),n=(0,y.Dm)((0,y.TD)(t)),r="";for(let e=0;e<n.length;e++)r+=String.fromCharCode(n[e]);let o=btoa(r),i=`${window.location.origin}${window.location.pathname}?diagram=${encodeURIComponent(o)}`,a=JSON.stringify(e,null,2);return{shareLink:i,diagramJson:a}},[$,C,S,I,N,T]),D=(0,m.use)(E),[B,P]=m.useState(null),z=async()=>{if(!D)return;let e=new Blob([D.diagramJson],{type:"application/json"});if("showSaveFilePicker"in window)try{let t=await window.showSaveFilePicker({suggestedName:n??"diagram.json",types:[{description:"JSON File",accept:{"application/json":[".json"]}}]}),r=t.name,o=await t.createWritable();await o.write(e),await o.close(),P(r);return}catch(e){if("AbortError"===e.name)return}let t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="diagram.json",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t),P("diagram.json")};m.useEffect(()=>{null!==B&&0!==B.length&&(r(B),setTimeout(()=>{P(null)},5e3))},[B,r]);let[R,H]=m.useState(!1);return(0,o.jsxs)(a.Z,{onClose:()=>{O(),H(!1)},open:t,fullWidth:!0,maxWidth:"md",keepMounted:!1,children:[(0,o.jsx)(s.Z,{children:"Export Diagram"}),(0,o.jsx)(l.Z,{children:(0,o.jsxs)(u.Z,{spacing:2,children:[(0,o.jsx)(d.Z,{variant:"h6",children:"Share"}),(0,o.jsxs)(c.Z,{children:[(0,o.jsx)(p.Z,{variant:"outlined",value:null==D?void 0:D.shareLink,fullWidth:!0,size:"small"}),(0,o.jsx)(f.Z,{variant:"contained","aria-label":"copy share link",onClick:()=>{D&&!R&&(navigator.clipboard.writeText(D.shareLink),H(!0))},children:R?(0,o.jsx)(x.xk,{symbol:"check"}):(0,o.jsx)(x.xk,{symbol:"content_copy"})})]}),(0,o.jsxs)(u.Z,{direction:"row",justifyContent:"space-between",children:[(0,o.jsx)(d.Z,{variant:"h6",children:"Export JSON"}),(0,o.jsx)(f.Z,{variant:"contained",onClick:z,startIcon:B?(0,o.jsx)(x.xk,{symbol:"check_circle"}):(0,o.jsx)(x.xk,{symbol:"download"}),sx:{backgroundColor:B?q.palette.success.main:null},children:B?"string"==typeof B?`Saved ${B}`:"Downloaded":"Download"})]}),(0,o.jsx)(p.Z,{multiline:!0,maxRows:20,variant:"outlined",value:null==D?void 0:D.diagramJson,slotProps:{htmlInput:{sx:{fontFamily:"monospace"}}}})]})}),(0,o.jsx)(h.Z,{children:(0,o.jsx)(f.Z,{onClick:O,children:"Close"})})]})}[g,j,k,x]=O.then?(await O)():O;let S=e=>(0,o.jsx)(m.Suspense,{children:(0,o.jsx)(C,{...e})});r()}catch(e){r(e)}})},9138:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>f});var o=n(4381),i=n(716),a=n(323),s=n(3023),l=n(788),u=n(8223),d=n(707),c=n(3943),p=e([c]);c=(p.then?(await p)():p)[0];let f=function(e){let{node:t,onChange:n,onDelete:r,children:p}=e;return(0,o.jsxs)(i.Z,{children:[(0,o.jsx)(a.Z,{title:"Edit Operation",action:(0,o.jsx)(s.Z,{color:"error",onClick:()=>null==r?void 0:r({type:"remove",id:t.id}),children:(0,o.jsx)(c.xk,{symbol:"delete"})})}),(0,o.jsx)(l.Z,{children:(0,o.jsxs)(u.Z,{spacing:2,children:[(0,o.jsx)(d.Z,{required:!0,label:"id",fullWidth:!0,value:t.data.opId,onChange:e=>{let r={...t};r.data.opId=e.target.value,null==n||n({type:"replace",id:t.id,item:r})}}),p]})})]})};r()}catch(e){r(e)}})},7210:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{p:()=>g});var o=n(4381),i=n(1725),a=n(6391),s=n(3452),l=n(7608),u=n(707),d=n(6722),c=n(3749),p=n(6113),f=n(2854),h=n(7817),y=n(5065),m=n(106),b=e([f,h]);function g(e){let{edge:t,onChange:n}=e,r=(0,c.useId)(),b=(0,f.zQ)(),g=b.tryGetNode(t.target),x=(null==g?void 0:g.type)==="section",_=(0,h.c)(),[j,w]=(0,y.z)(),v=(0,c.useMemo)(()=>{if(!g||"section"!==g.type)return[];if("string"==typeof g.data.op.builder){let e=_.sections[g.data.op.builder];return e?Object.keys(e.metadata.buffers):[]}if("string"!=typeof g.data.op.template)return[];{let e=j[g.data.op.template];return e&&e.buffers?Array.isArray(e.buffers)?e.buffers:Object.keys(e.buffers):[]}},[g,_,j]),k=e=>{switch(t.data.input.type){case"bufferKey":{let r=e.target.value;null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,input:{type:"bufferKey",key:r}}}});break}case"bufferSeq":{let r=Number.parseInt(e.target.value,10);Number.isNaN(r)||null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,input:{type:"bufferSeq",seq:r}}}});break}case"sectionBuffer":{let r=e.target.value;null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,input:{type:"sectionBuffer",inputId:r}}}});break}default:throw(0,m.y)(t.data.input),Error("unknown edge input")}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.Z,{children:[(0,o.jsx)(a.Z,{id:r,children:"Slot"}),(0,o.jsxs)(s.Z,{labelId:r,label:"Slot",value:t.data.input.type,onChange:e=>{null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,input:function(e){switch(e){case"bufferKey":return{type:"bufferKey",key:""};case"bufferSeq":return{type:"bufferSeq",seq:0};case"sectionBuffer":return{type:"sectionBuffer",inputId:""};default:throw(0,m.y)(e),Error("unknown buffer edge input type")}}(e.target.value)}}})},children:[!x&&(0,o.jsx)(l.Z,{value:"bufferSeq",children:"Index"}),!x&&(0,o.jsx)(l.Z,{value:"bufferKey",children:"Key"}),x&&(0,o.jsx)(l.Z,{value:"sectionBuffer",children:"Section Buffer"})]})]}),void 0===t.data.input||"bufferSeq"===t.data.input.type&&(0,o.jsx)(u.Z,{label:"Index",type:"number",value:t.data.input.seq,onChange:k,fullWidth:!0}),"bufferKey"===t.data.input.type&&(0,o.jsx)(u.Z,{label:"Key",value:t.data.input.key,onChange:k,fullWidth:!0}),"sectionBuffer"===t.data.input.type&&(0,o.jsx)(d.Z,{freeSolo:!0,autoSelect:!0,options:v,value:t.data.input.inputId,onChange:(e,r)=>{null==n||n({type:"replace",id:t.id,item:{...t,data:{output:t.data.output,input:{type:"sectionBuffer",inputId:r||""}}}})},renderInput:e=>(0,o.jsx)(u.Z,{...e,required:!0,label:"Section Buffer"})}),"join"===b.getNode(t.target).type&&(0,o.jsxs)(i.Z,{children:[(0,o.jsx)(a.Z,{id:`${r}-fetch-type`,children:"Fetch Type"}),(0,o.jsxs)(s.Z,{labelId:r,label:"Fetch Type",value:t.data.input.fetchType||p.fe.Pull,onChange:e=>{null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,input:{...t.data.input,fetchType:e.target.value}}}})},children:[(0,o.jsx)(l.Z,{value:p.fe.Pull,children:"Pull"}),(0,o.jsx)(l.Z,{value:p.fe.Clone,children:"Clone"})]})]})]})}[f,h]=b.then?(await b)():b,r()}catch(e){r(e)}})},4853:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>b});var o=n(4381),i=n(8223),a=n(1725),s=n(6391),l=n(3452),u=n(7608),d=n(707),c=n(6495),p=n(2878),f=n(3749),h=n(1275),y=n(9138),m=e([y]);y=(m.then?(await m)():m)[0];let b=function(e){var t;let{node:n,onChange:r}=e,{op:m}=n.data,b=f.useId(),g=(null==(t=m.settings)?void 0:t.retention)??{keep_last:1},x=(0,h.L)(g),_="keep_all"===g?1:Object.values(g)[0];return(0,o.jsxs)(y.Z,{...e,children:[(0,o.jsxs)(i.Z,{direction:"row",spacing:2,minWidth:300,children:[(0,o.jsxs)(a.Z,{fullWidth:!0,children:[(0,o.jsx)(s.Z,{id:b,children:"Retention Policy"}),(0,o.jsxs)(l.Z,{labelId:b,value:x,label:"Retention Policy",onChange:e=>{let t,o=e.target.value;if("keep_all"===o)t="keep_all";else if("keep_first"===o)t={keep_first:_};else if("keep_last"===o)t={keep_last:_};else throw Error(`Invalid retention mode: ${o}`);let i={...n};i.data.op={...m,settings:{...m.settings,retention:t}},null==r||r({type:"replace",id:n.id,item:i})},children:[(0,o.jsx)(u.Z,{value:"keep_last",children:"Keep Last"}),(0,o.jsx)(u.Z,{value:"keep_first",children:"Keep First"}),(0,o.jsx)(u.Z,{value:"keep_all",children:"Keep All"})]})]}),("keep_first"===x||"keep_last"===x)&&(0,o.jsx)(d.Z,{type:"number",label:"Amount",value:_,onChange:e=>{let t,o=parseInt(e.target.value,10);if(o<1||!Number.isInteger(o))return;if("keep_first"===x)t={keep_first:o};else if("keep_last"===x)t={keep_last:o};else throw Error(`Invalid retention mode for value change: ${x}`);let i={...n};i.data.op={...m,settings:{...m.settings,retention:t}},null==r||r({type:"replace",id:n.id,item:i})},slotProps:{htmlInput:{min:1,step:1}}})]}),(0,o.jsx)(c.Z,{control:(0,o.jsx)(p.Z,{checked:m.serialize??!1,onChange:(e,t)=>{let o={...n};o.data.op={...m,serialize:t},null==r||r({type:"replace",id:n.id,item:o})}}),label:"Serialize"})]})};r()}catch(e){r(e)}})},4425:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{s:()=>h});var o=n(4381),i=n(6722),a=n(707),s=n(3749),l=n(6113),u=n(2854),d=n(3943),c=n(7817),p=n(5065),f=e([u,c,d]);function h(e){let{edge:t,onChange:n}=e,r=(0,u.zQ)(),f=(0,c.c)(),[h,y]=(0,p.z)(),m=r.tryGetNode(t.target),b=(0,s.useMemo)(()=>{if(!m||!(0,d.J5)(m))return[];if("string"==typeof m.data.op.builder){let e=f.sections[m.data.op.builder];return Object.keys((null==e?void 0:e.metadata.inputs)||{})}if("string"!=typeof m.data.op.template)return[];{let e=h[m.data.op.template];return e&&e.inputs?Array.isArray(e.inputs)?e.inputs:Object.keys(e.inputs):[]}},[m,f,h]);return(0,l.lJ)(t)?(0,o.jsx)(o.Fragment,{children:(null==m?void 0:m.type)==="section"&&(0,o.jsx)(i.Z,{freeSolo:!0,autoSelect:!0,options:b,value:"sectionInput"===t.data.input.type?t.data.input.inputId:"",onChange:(e,r)=>{null==n||n({type:"replace",id:t.id,item:{...t,data:{output:t.data.output,input:{type:"sectionInput",inputId:r||""}}}})},renderInput:e=>(0,o.jsx)(a.Z,{...e,required:!0,label:"Section Input"})})}):null}[u,c,d]=f.then?(await f)():f,r()}catch(e){r(e)}})},8541:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>C,q:()=>k});var o=n(4381),i=n(716),a=n(323),s=n(3023),l=n(788),u=n(8223),d=n(1725),c=n(6391),p=n(3452),f=n(7608),h=n(3749),y=n(3943),m=n(106),b=n(7210),g=n(4425),x=n(5315),_=n(389),j=n(2819),w=n(4038),v=e([b,j,x,y,g]);[b,j,x,y,g]=v.then?(await v)():v;let Z={buffer:"Buffer",default:"Default",forkResultErr:"Error",forkResultOk:"Ok",splitKey:"Key",splitRemaining:"Remaining",splitSeq:"Sequence",streamOut:"Stream Out",unzip:"Unzip",section:"Section"},O={default:{output:{},input:{type:"default"}},buffer:{output:{},input:{type:"bufferSeq",seq:0}},forkResultOk:{output:{},input:{type:"default"}},forkResultErr:{output:{},input:{type:"default"}},splitKey:{output:{key:""},input:{type:"default"}},splitSeq:{output:{seq:0},input:{type:"default"}},splitRemaining:{output:{},input:{type:"default"}},streamOut:{output:{streamId:""},input:{type:"default"}},unzip:{output:{seq:0},input:{type:"default"}},section:{output:{output:""},input:{type:"default"}}};function k(e){return{...O[e]}}let C=function(e){let{edge:t,allowedEdgeTypes:n,nodeManager:r,onChange:v,onDelete:O}=e,C=h.useMemo(()=>{switch(t.type){case"buffer":return(0,o.jsx)(b.p,{edge:t,onChange:v});case"streamOut":return(0,o.jsx)(j.v,{edge:t,nodeManager:r,onChange:v});case"default":case"forkResultOk":case"forkResultErr":return null;case"splitKey":case"splitRemaining":case"splitSeq":return(0,o.jsx)(_.Z,{edge:t,onChange:v});case"unzip":return(0,o.jsx)(w.Z,{edge:t,onChange:v});case"section":return(0,o.jsx)(x.yB,{edge:t,onChange:v});default:throw(0,m.y)(t),Error("unknown edge type")}},[t,r,v]),S=h.useId();return(0,o.jsxs)(i.Z,{sx:{minWidth:250},children:[(0,o.jsx)(a.Z,{title:"Edit Connection",action:(0,o.jsx)(s.Z,{color:"error",onClick:()=>O({type:"remove",id:t.id}),children:(0,o.jsx)(y.xk,{symbol:"delete"})})}),(0,o.jsx)(l.Z,{children:(0,o.jsxs)(u.Z,{spacing:2,children:[(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(c.Z,{id:S,children:"Type"}),(0,o.jsx)(p.Z,{labelId:S,label:"Type",value:t.type,onChange:e=>{let n={...t};n.type=e.target.value,n.data=k(n.type),v({type:"replace",id:t.id,item:n})},children:n.map(e=>(0,o.jsx)(f.Z,{value:e,children:Z[e]},e))})]}),(0,o.jsx)(g.s,{edge:t,onChange:v}),C]})})]})};r()}catch(e){r(e)}})},2229:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>b});var o=n(4381),i=n(3943),a=n(106),s=n(9138),l=n(4853),u=n(8463),d=n(1651),c=n(4775),p=n(5315),f=n(8252),h=n(6505),y=e([c,l,d,u,h,f,s,i,p]);function m(e){switch(e.node.data.op.type){case"node":return(0,o.jsx)(c.Z,{...e});case"buffer":return(0,o.jsx)(l.Z,{...e});case"join":return(0,o.jsx)(d.Z,{...e});case"scope":return(0,o.jsx)(u.Z,{...e});case"section":return(0,o.jsx)(p.U1,{...e});case"transform":return(0,o.jsx)(h.Z,{...e});case"stream_out":return(0,o.jsx)(f.E,{...e});default:return(0,o.jsx)(s.Z,{...e})}}[c,l,d,u,h,f,s,i,p]=y.then?(await y)():y;let b=function(e){if((0,i.on)(e.node))return(0,o.jsx)(m,{...e,node:e.node});if(!(0,i.Vx)(e.node))return null;switch(e.node.type){case"sectionInput":return(0,o.jsx)(p.iH,{...e,node:e.node});case"sectionOutput":return(0,o.jsx)(p.bM,{...e,node:e.node});case"sectionBuffer":return(0,o.jsx)(p.h2,{...e,node:e.node});default:throw(0,a.y)(e.node),Error("unknown node type")}};r()}catch(e){r(e)}})},8463:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>u});var o=n(4381),i=n(9849),a=n(3943),s=n(9138),l=e([s,a]);[s,a]=l.then?(await l)():l;let u=function(e){let{onAddOperationClick:t,...n}=e;return(0,o.jsx)(s.Z,{...n,children:(0,o.jsx)(i.Z,{variant:"contained",startIcon:(0,o.jsx)(a.xk,{symbol:"add"}),onClick:t,children:"Add Operation"})})};r()}catch(e){r(e)}})},6884:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{B6:()=>i.Z,qV:()=>o.q,tT:()=>o.Z});var o=n(8541),i=n(2229),a=n(8463),s=e([o,i,a]);[o,i,a]=s.then?(await s)():s,r()}catch(e){r(e)}})},1651:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>u});var o=n(4381),i=n(6495),a=n(2084),s=n(9138),l=e([s]);s=(l.then?(await l)():l)[0];let u=function(e){let t=e.node.data.op;return(0,o.jsx)(s.Z,{...e,children:(0,o.jsx)(i.Z,{label:"Serialize",control:(0,o.jsx)(a.Z,{checked:!!t.serialize}),onChange:(t,n)=>{var r;let o={...e.node};o.data.op={...o.data.op,serialize:n},null==(r=e.onChange)||r.call(e,{type:"replace",id:e.node.id,item:o})}})})};r()}catch(e){r(e)}})},4775:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>y});var o=n(4381),i=n(707),a=n(6722),s=n(4903),l=n(8223),u=n(7461),d=n(3749),c=n(3943),p=n(7817),f=n(9138),h=e([p,f,c]);[p,f,c]=h.then?(await h)():h;let y=function(e){let t=(0,p.c)(),n=Object.keys(t.nodes).sort(),[r,h]=(0,d.useState)(()=>e.node.data.op.config?JSON.stringify(e.node.data.op.config):""),y=(0,d.useMemo)(()=>{if(""===r)return!1;try{return JSON.parse(r),!1}catch{return!0}},[r]);return(0,o.jsxs)(f.Z,{...e,children:[(0,o.jsx)(i.Z,{label:"Display Text",value:e.node.data.op.display_text||"",onChange:t=>{try{var n;let r={...e.node};r.data.op.display_text=t.target.value||void 0,null==(n=e.onChange)||n.call(e,{type:"replace",id:e.node.id,item:r})}catch{}}}),(0,o.jsx)(a.Z,{freeSolo:!0,autoSelect:!0,options:n,getOptionLabel:e=>e,value:e.node.data.op.builder,onChange:(t,n)=>{var r;let o={...e.node};o.data.op.builder=n??"",null==(r=e.onChange)||r.call(e,{type:"replace",id:e.node.id,item:o})},renderInput:e=>(0,o.jsx)(i.Z,{...e,required:!0,label:"Builder"}),renderOption:(e,n)=>{let{key:r,...i}=e,a=t.nodes[n];return(0,o.jsx)(s.ZP,{...i,children:(0,o.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",width:"100%",children:[(0,o.jsx)("span",{children:n}),(null==a?void 0:a.description)&&(0,o.jsx)(u.Z,{title:a.description,children:(0,o.jsx)(c.xk,{symbol:"info"})})]})},r)}}),(0,o.jsx)(i.Z,{multiline:!0,rows:4,label:"Config",value:r,onChange:t=>{h(t.target.value);try{var n;let r={...e.node};r.data.op.config=""===t.target.value?void 0:JSON.parse(t.target.value),null==(n=e.onChange)||n.call(e,{type:"replace",id:e.node.id,item:r})}catch{}},error:y,slotProps:{htmlInput:{sx:{fontFamily:"monospace",whiteSpace:"nowrap"}}}})]})};r()}catch(e){r(e)}})},5315:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{U1:()=>v,bM:()=>w,h2:()=>j,iH:()=>_,yB:()=>k});var o=n(4381),i=n(716),a=n(323),s=n(3023),l=n(788),u=n(8223),d=n(707),c=n(6722),p=n(3749),f=n(2854),h=n(3943),y=n(7817),m=n(5065),b=n(9138),g=e([b,f,y,h]);function x(e){let{node:t,onDelete:n,children:r}=e;return(0,o.jsxs)(i.Z,{children:[(0,o.jsx)(a.Z,{title:"Edit",action:(0,o.jsx)(s.Z,{color:"error",onClick:()=>null==n?void 0:n({type:"remove",id:t.id}),children:(0,o.jsx)(h.xk,{symbol:"delete"})})}),(0,o.jsx)(l.Z,{children:r})]})}function _(e){let{node:t,onChange:n,onDelete:r}=e;return(0,o.jsx)(x,{node:t,onDelete:r,children:(0,o.jsx)(u.Z,{spacing:2,children:(0,o.jsx)(d.Z,{required:!0,label:"Remapped Id",value:t.data.remappedId,onChange:e=>{let r={...t};r.data.remappedId=e.target.value,null==n||n({type:"replace",id:t.id,item:r})}})})})}function j(e){let{node:t,onChange:n,onDelete:r}=e;return(0,o.jsx)(x,{node:t,onDelete:r,children:(0,o.jsx)(u.Z,{spacing:2,children:(0,o.jsx)(d.Z,{required:!0,label:"Remapped Id",value:t.data.remappedId,onChange:e=>{let r={...t};r.data.remappedId=e.target.value,null==n||n({type:"replace",id:t.id,item:r})}})})})}function w(e){let{node:t,onChange:n,onDelete:r}=e;return(0,o.jsx)(x,{node:t,onDelete:r,children:(0,o.jsx)(u.Z,{spacing:2,children:(0,o.jsx)(d.Z,{required:!0,label:"Output Id",value:t.data.outputId,onChange:e=>{let r={...t};r.data.outputId=e.target.value,null==n||n({type:"replace",id:t.id,item:r})}})})})}function v(e){let t=(0,y.c)(),[n,r]=(0,m.z)(),i=Object.keys(t.sections),a=Object.keys(n),s=[...i,...a].sort();return(0,o.jsxs)(b.Z,{...e,children:[(0,o.jsx)(d.Z,{label:"Display Text",value:e.node.data.op.display_text||"",onChange:t=>{try{var n;let r={...e.node};r.data.op.display_text=t.target.value||void 0,null==(n=e.onChange)||n.call(e,{type:"replace",id:e.node.id,item:r})}catch{}}}),(0,o.jsx)(c.Z,{freeSolo:!0,autoSelect:!0,options:s,getOptionLabel:e=>e,value:e.node.data.op.builder||e.node.data.op.template||"",onChange:(t,n)=>{var r;if(null===n)return;let o={...e.node};i.includes(n)?(o.data.op.builder=n,delete o.data.op.template):(a.includes(n),o.data.op.template=n,delete o.data.op.builder),null==(r=e.onChange)||r.call(e,{type:"replace",id:e.node.id,item:o})},renderInput:e=>(0,o.jsx)(d.Z,{...e,required:!0,label:"builder/template"})})]})}function k(e){let{edge:t,onChange:n}=e,r=(0,f.zQ)(),i=(0,y.c)(),[a,s]=(0,m.z)(),l=r.tryGetNode(t.source),u=(0,p.useMemo)(()=>{if(!(l&&(0,h.J5)(l)))return console.error("source node of a section edge is not a section node"),[];if("string"==typeof l.data.op.builder){let e=i.sections[l.data.op.builder];return Object.keys((null==e?void 0:e.metadata.outputs)||{})}if("string"!=typeof l.data.op.template)return[];{let e=a[l.data.op.template];return(null==e?void 0:e.outputs)||[]}},[l,i,a]);return(0,o.jsx)(c.Z,{freeSolo:!0,autoSelect:!0,options:u,getOptionLabel:e=>e,value:t.data.output.output,onChange:(e,r)=>{null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,output:{output:r||""}}}})},renderInput:e=>(0,o.jsx)(d.Z,{...e,required:!0,label:"Section Output"})})}[b,f,y,h]=g.then?(await g)():g,r()}catch(e){r(e)}})},389:function(e,t,n){n.d(t,{Z:()=>i});var r=n(4381),o=n(707);let i=function(e){let{edge:t,onChange:n}=e,i=e=>{if("splitKey"===t.type){let r=e.target.value;null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,output:{key:r}}}})}else if("splitSeq"===t.type){let r=Number.parseInt(e.target.value,10);Number.isNaN(r)||null==n||n({type:"replace",id:t.id,item:{...t,data:{...t.data,output:{seq:r}}}})}};return(0,r.jsxs)(r.Fragment,{children:["splitKey"===t.type&&(0,r.jsx)(o.Z,{label:"Key",value:t.data.output.key??"",onChange:i,fullWidth:!0}),"splitSeq"===t.type&&(0,r.jsx)(o.Z,{label:"Sequence",type:"number",value:t.data.output.seq??0,onChange:i,fullWidth:!0})]})}},2819:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{v:()=>d});var o=n(4381),i=n(6722),a=n(707),s=n(3943),l=n(7817),u=e([l,s]);function d(e){let{edge:t,nodeManager:n,onChange:r}=e,u=(0,l.c)(),d=n.getNode(t.source),c=(0,s.on)(d)&&"node"===d.data.op.type?u.nodes[d.data.op.builder]:null,p=c?Object.keys(c.streams):[];return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(i.Z,{freeSolo:!0,autoSelect:!0,fullWidth:!0,options:p,getOptionLabel:e=>e,value:t.data.output.streamId,onChange:(e,n)=>{null==r||r({type:"replace",id:t.id,item:{...t,data:{...t.data,output:{streamId:n||""}}}})},renderInput:e=>(0,o.jsx)(a.Z,{...e,required:!0,label:"Stream"})})})}[l,s]=u.then?(await u)():u,r()}catch(e){r(e)}})},8252:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{E:()=>l});var o=n(4381),i=n(707),a=n(9138),s=e([a]);function l(e){return(0,o.jsx)(a.Z,{...e,children:(0,o.jsx)(i.Z,{required:!0,label:"Stream",fullWidth:!0,value:e.node.data.op.name,onChange:t=>{var n;let r={...e.node};r.data.op.name=t.target.value,null==(n=e.onChange)||n.call(e,{type:"replace",id:e.node.id,item:r})}})})}a=(s.then?(await s)():s)[0],r()}catch(e){r(e)}})},6505:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>d});var o=n(4381),i=n(707),a=n(2385),s=n(3749),l=n(9138),u=e([l]);l=(u.then?(await u)():u)[0];let d=function(e){let t=s.useMemo(()=>(0,a.Qc)(e.node.data.op.cel).isSuccess,[e.node.data.op.cel]);return(0,o.jsx)(l.Z,{...e,children:(0,o.jsx)(i.Z,{label:"CEL",multiline:!0,fullWidth:!0,sx:{width:300},value:e.node.data.op.cel,slotProps:{htmlInput:{style:{fontFamily:"monospace",whiteSpace:"pre"}}},error:!t,onChange:t=>{var n;let r={...e.node,data:{...e.node.data,op:{...e.node.data.op,cel:t.target.value}}};null==(n=e.onChange)||n.call(e,{type:"replace",id:e.node.id,item:r})}})})};r()}catch(e){r(e)}})},4038:function(e,t,n){n.d(t,{Z:()=>i});var r=n(4381),o=n(707);let i=function(e){var t;let{edge:n,onChange:i}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(o.Z,{label:"index",type:"number",value:(null==(t=n.data)?void 0:t.seq)??0,onChange:e=>{let t=Number.parseInt(e.target.value,10);!Number.isNaN(t)&&n.data&&(n.data.seq=t,null==i||i({type:"replace",id:n.id,item:n}))}})})}},522:function(e,t,n){n.d(t,{HH:()=>c,gZ:()=>u,vH:()=>l});var r,o,i=n(4381),a=n(3796),s=n(106),l=((r={}).DataStream="dataStream",r.ForkResultOk="forkResultOk",r.ForkResultErr="forkResultErr",r),u=((o={})[o.Data=0]="Data",o[o.Buffer=1]="Buffer",o[o.DataStream=2]="DataStream",o[o.DataBuffer=3]="DataBuffer",o);function d(e){if(void 0!==e)switch(e){case 0:return;case 1:return"handle-buffer";case 3:return"handle-data-buffer";case 2:return"handle-data-stream";default:throw(0,s.y)(e),Error("unknown edge category")}}function c(e){let{id:t,variant:n,className:r,...o}=e,s=r?`${d(n)} ${r} `:d(n);return(0,i.jsx)(a.HH,{...o,id:t,className:s})}},6717:function(e,t,n){n.a(e,async function(e,t){try{var r=n(4381);n(6018);var o=n(3749),i=n(8721),a=n(2585),s=e([a]);a=(s.then?(await s)():s)[0];let l=document.getElementById("root");l&&i.createRoot(l).render((0,r.jsx)(o.StrictMode,{children:(0,r.jsx)(a.Z,{})})),t()}catch(e){t(e)}})},4573:function(e,t,n){n.d(t,{e:()=>a,s:()=>i});var r=n(3749);let o=(0,r.createContext)(null),i=o.Provider,a=()=>(0,r.useContext)(o)},2854:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Bl:()=>p,b:()=>h,zQ:()=>c});var o=n(4674),i=n(3749),a=n(3943),s=n(106),l=n(4187),u=n(1692),d=e([u,a]);[u,a]=d.then?(await d)():d;class p{tryGetNode(e){return this.nodeIdMap.get(e)||null}getNode(e){let t=this.tryGetNode(e);if(!t)throw Error(`cannot find node "${e}"`);return t}iterNodes(){return this.nodeIdMap.values()}hasNode(e){try{return this.getNode(e),!0}catch{return!1}}getNodeFromNamespaceOpId(e,t){let n=(0,l.Tz)(e,t),r=this.namespacedOpIdMap.get(n);if(!r)throw Error(`cannot find node for operation "${n}"`);return r}getNodeFromRootOpId(e){return this.getNodeFromNamespaceOpId(l.He,e)}getNodeFromNextOp(e,t){if((0,u.i4)(t))switch(t.builtin){case"dispose":case"cancel":return null;case"terminate":return this.getNode((0,l.Tz)(e,a.fc))}let n="object"==typeof t?Object.keys(t)[0]:t,r=(0,l.Tz)(e,n),o=this.namespacedOpIdMap.get(r);if(!o)throw Error(`cannot find operation ${(0,l.Tz)(e,n)}`);return o}getTargetNextOp(e){switch(e.data.input.type){case"bufferKey":case"bufferSeq":case"default":{let t=this.getNode(e.target);if((0,a.KC)(t))return{builtin:t.type};if((0,a.on)(t))return t.data.opId;if("sectionOutput"===t.type)return t.data.outputId;throw Error("unknown node type")}case"sectionBuffer":case"sectionInput":{let t=this.getNode(e.target);if("section"!==t.type)throw Error("edge is connecting to a section input slot but target is not a section");return{[t.data.opId]:e.data.input.inputId}}default:throw(0,s.y)(e.data.input),Error("unknown edge input")}}constructor(e){for(let t of((0,o._)(this,"nodes",void 0),(0,o._)(this,"nodeIdMap",void 0),(0,o._)(this,"namespacedOpIdMap",void 0),this.nodes=e,this.nodeIdMap=new Map,this.namespacedOpIdMap=new Map,e))if(this.nodeIdMap.set(t.id,t),(0,a.on)(t)){let e=(0,l.Tz)(t.data.namespace,t.data.opId);this.namespacedOpIdMap.set(e,t)}else(0,a.KC)(t)?this.namespacedOpIdMap.set(t.id,t):"sectionOutput"===t.type&&this.namespacedOpIdMap.set((0,l.Tz)(l.He,t.data.outputId),t)}}let f=(0,i.createContext)(new p([])),h=f.Provider;function c(){return(0,i.useContext)(f)}r()}catch(e){r(e)}})},3970:function(e,t,n){n.d(t,{Z:()=>c});var r=n(4381),o=n(8355),i=n(9849),a=n(8223),s=n(9229),l=n(4790),u=n(3749),d=n(6713);let c=(0,u.memo)(function(e){let{color:t,icon:n,label:u,caption:c,handles:p,selected:f}=e,h="string"==typeof n?(0,r.jsx)("span",{className:`material-symbols-${n}`}):n;return(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(i.Z,{title:u,color:t,fullWidth:!0,startIcon:h,variant:f?"contained":"outlined",sx:{textTransform:"none",width:d.O.nodeWidth,height:d.O.nodeHeight},children:(0,r.jsxs)(a.Z,{children:[(0,r.jsx)(s.Z,{component:"span",sx:{minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u}),c&&(0,r.jsx)(l.Z,{variant:"caption",fontSize:8,sx:{minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c})]})}),p]})})},5602:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.Zt,{}),label:"Buffer Access",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.DataBuffer}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Data})]})})}},115:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.Es,{}),label:"Buffer",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.Data}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Buffer})]})})}},6352:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Ac:()=>y,B0:()=>f,bO:()=>d,kj:()=>p,mq:()=>u,nJ:()=>c,ou:()=>h});var o=n(9426),i=n(6713),a=n(4187),s=n(3943),l=e([s]);function u(e,t){return{id:(0,a.Tz)(e,s.M8),type:"start",position:t,selectable:!1,data:{namespace:e}}}function d(e,t){return{id:(0,a.Tz)(e,s.fc),type:"terminate",position:t,selectable:!1,data:{namespace:e}}}function c(e,t,n){return{id:(0,o.Z)(),type:"sectionInput",data:{remappedId:e,targetId:t},position:n}}function p(e,t){return{id:(0,o.Z)(),type:"sectionOutput",data:{outputId:e},position:t}}function f(e,t,n){return{id:(0,o.Z)(),type:"sectionBuffer",data:{remappedId:e,targetId:t},position:n}}function h(e,t,n,r,i){return{id:(0,o.Z)(),type:r.type,position:n,data:{namespace:e,opId:i,op:r},...t&&{parentId:t}}}function y(e,t,n,r,l){let u=(0,o.Z)(),d=[{id:(0,a.Tz)(e,l,s.M8),type:"start",position:{x:i.O.scopePadding.leftRight,y:i.O.scopePadding.topBottom},data:{namespace:(0,a.Tz)(e,u)},parentId:u},{id:(0,a.Tz)(e,l,s.fc),type:"terminate",position:{x:i.O.scopePadding.leftRight,y:5*i.O.scopePadding.topBottom},data:{namespace:(0,a.Tz)(e,u)},parentId:u}],c=(0,i.e)(d.map(e=>e.position));return[{id:u,type:"scope",position:{x:n.x+c.x,y:n.y+c.y},data:{namespace:e,opId:l,op:r},width:c.width,height:c.height,zIndex:-1,...t&&{parentId:t}},...d]}s=(l.then?(await l)():l)[0],r()}catch(e){r(e)}})},8395:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.Vd,{}),label:"Fork Clone",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.Data}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Data})]})})}},8418:function(e,t,n){n.d(t,{Z:()=>c});var r=n(4381),o=n(1164),i=n(7373),a=n(522),s=n(3970),l=n(4343);let u=(0,o.ZP)(a.HH)(e=>{let{theme:t}=e;return{left:"25%",background:`linear-gradient(-45deg, ${t.palette.success.main} 50%, var(--xy-handle-background-color-default) 50%)`}}),d=(0,o.ZP)(a.HH)(e=>{let{theme:t}=e;return{left:"75%",background:`linear-gradient(-45deg, ${t.palette.error.main} 50%, var(--xy-handle-background-color-default) 50%)`}}),c=function(e){return(0,r.jsx)(s.Z,{...e,icon:(0,r.jsx)(l.Hu,{}),label:"Fork Result",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.HH,{type:"target",position:i.Ly.Top,isConnectable:e.isConnectable,variant:a.gZ.Data}),(0,r.jsx)(u,{id:a.vH.ForkResultOk,type:"source",position:i.Ly.Bottom,isConnectable:e.isConnectable,variant:a.gZ.Data}),(0,r.jsx)(d,{id:a.vH.ForkResultErr,type:"source",position:i.Ly.Bottom,isConnectable:e.isConnectable,variant:a.gZ.Data})]})})}},4343:function(e,t,n){n.d(t,{Cz:()=>j,Es:()=>u,G9:()=>g,Hu:()=>p,RR:()=>m,UD:()=>b,UM:()=>f,Vd:()=>s,Zt:()=>d,dY:()=>l,hF:()=>_,k_:()=>x,kz:()=>c,qh:()=>a,sI:()=>y,xk:()=>i,yQ:()=>h});var r=n(4381),o=n(9229);function i(e){let{symbol:t,className:n,...i}=e;return(0,r.jsx)(o.Z,{component:"span",className:`material-symbols-outlined ${n}`,...i,children:t})}function a(){return(0,r.jsx)(i,{symbol:"line_start_circle"})}function s(){return(0,r.jsx)(i,{symbol:"content_copy"})}function l(){return(0,r.jsx)(i,{symbol:"change_circle"})}function u(){return(0,r.jsx)(i,{symbol:"database"})}function d(){return(0,r.jsx)(i,{symbol:"database_upload"})}function c(){return(0,r.jsx)(i,{symbol:"call_split",sx:{transform:"scaleY(-1)"}})}function p(){return(0,r.jsx)(i,{symbol:"question_mark"})}function f(){return(0,r.jsx)(i,{symbol:"hearing"})}function h(){return(0,r.jsx)(i,{symbol:"arrow_and_edge"})}function y(){return(0,r.jsx)(i,{symbol:"notes"})}function m(){return(0,r.jsx)(i,{symbol:"rectangle"})}function b(){return(0,r.jsx)(i,{symbol:"select_all"})}function g(){return(0,r.jsx)(i,{symbol:"input"})}function x(){return(0,r.jsx)(i,{symbol:"output"})}function _(){return(0,r.jsx)(i,{symbol:"database"})}function j(){return(0,r.jsx)(i,{symbol:"format_list_numbered"})}},3943:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Ac:()=>x.Ac,B0:()=>x.B0,Cz:()=>_.Cz,D5:()=>j.D5,Es:()=>_.Es,G9:()=>_.G9,Hu:()=>_.Hu,J5:()=>j.J5,KC:()=>j.KC,M8:()=>v,RR:()=>_.RR,UD:()=>_.UD,UM:()=>_.UM,Vd:()=>_.Vd,Vx:()=>j.bO,Zt:()=>_.Zt,bO:()=>x.bO,dY:()=>_.dY,fc:()=>k,hF:()=>_.hF,jG:()=>j.jG,kL:()=>Z,k_:()=>_.k_,kj:()=>x.kj,kz:()=>_.kz,mq:()=>x.mq,nJ:()=>x.nJ,on:()=>j.on,ou:()=>x.ou,qh:()=>_.qh,sI:()=>_.sI,sw:()=>j.sw,xk:()=>_.xk,yQ:()=>_.yQ,yZ:()=>j.yZ});var o=n(5602),i=n(115),a=n(8395),s=n(8418),l=n(2821),u=n(1022),d=n(77),c=n(4190),p=n(5103),f=n(298),h=n(1465),y=n(8338),m=n(6805),b=n(7320),g=n(1565),x=n(6352),_=n(4343),j=n(8505),w=e([x,d,p]);[x,d,p]=w.then?(await w)():w;let v="__builtin_start__",k="__builtin_terminate__",Z={start:h.Z,terminate:m.Z,node:d.Z,section:p.ZP,sectionInput:p.w3,sectionOutput:p.mZ,sectionBuffer:p.Em,fork_clone:a.Z,unzip:g.Z,fork_result:s.Z,split:f.Z,join:l.Z,transform:b.Z,buffer:i.Z,buffer_access:o.Z,listen:u.Z,scope:c.Z,stream_out:y.Z};r()}catch(e){r(e)}})},2821:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.yQ,{}),label:"Join",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.Buffer}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Data})]})})}},1022:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.UM,{}),label:"Listen",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.Buffer}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Data})]})})}},77:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Z:()=>f});var o=n(4381),i=n(3796),a=n(7373),s=n(3749),l=n(522),u=n(7817),d=n(3970),c=n(4343),p=e([u]);u=(p.then?(await p)():p)[0];let f=function(e){let t=(0,u.c)().nodes[e.data.op.builder],n=e.data.op.display_text?e.data.op.display_text:t?t.default_display_text:"Select Builder",r=!!((null==t?void 0:t.streams)&&Object.keys(t.streams).length>0),p=(0,s.useRef)(r),f=(0,i.Bn)();return r!==p.current&&(p.current=r,f(e.id)),(0,o.jsx)(d.Z,{...e,icon:(0,o.jsx)(c.qh,{}),label:n||"Select Builder",caption:e.data.op.builder,handles:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.HH,{type:"target",position:a.Ly.Top,isConnectable:e.isConnectable,variant:l.gZ.Data},"data-target"),(0,o.jsx)(l.HH,{type:"source",position:a.Ly.Bottom,isConnectable:e.isConnectable,variant:l.gZ.Data},"data-source"),r&&(0,o.jsx)(l.HH,{id:l.vH.DataStream,type:"source",position:a.Ly.Right,isConnectable:e.isConnectable,variant:l.gZ.DataStream},"stream-source")]})})};r()}catch(e){r(e)}})},4190:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(3961),i=n(9229),a=n(7373),s=n(522);let l=function(e){let{isConnectable:t,sourcePosition:n=a.Ly.Bottom,targetPosition:l=a.Ly.Top,width:u,height:d}=e,c=(0,o.Z)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.HH,{type:"target",position:l,isConnectable:t,variant:s.gZ.Data}),(0,r.jsx)(i.Z,{sx:{opacity:.2,backgroundColor:c.palette.secondary.main,borderRadius:4,width:u,height:d,cursor:"pointer"}}),(0,r.jsx)(s.HH,{type:"source",position:n,isConnectable:t,variant:s.gZ.Data}),(0,r.jsx)(s.HH,{id:s.vH.DataStream,type:"source",position:a.Ly.Right,variant:s.gZ.DataStream})]})}},5103:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Em:()=>h,ZP:()=>y,mZ:()=>f,w3:()=>p});var o=n(4381),i=n(7373),a=n(522),s=n(7817),l=n(1692),u=n(3970),d=n(4343),c=e([s,l]);[s,l]=c.then?(await c)():c;let y=function(e){let t=(0,s.c)(),n=(()=>{if(e.data.op.display_text)return e.data.op.display_text;if((0,l.MK)(e.data.op)){let n=t.sections[e.data.op.builder];if(n)return n.default_display_text}else if(e.data.op.template)return"Template";return"Select Section"})(),r=(0,l.MK)(e.data.op)?e.data.op.builder:e.data.op.template;return(0,o.jsx)(u.Z,{...e,icon:(0,o.jsx)(d.UD,{}),label:n,caption:r,handles:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.HH,{type:"target",position:i.Ly.Top,isConnectable:e.isConnectable,variant:a.gZ.DataBuffer}),(0,o.jsx)(a.HH,{type:"source",position:i.Ly.Bottom,isConnectable:e.isConnectable,variant:a.gZ.Data})]})})};function p(e){return(0,o.jsx)(u.Z,{...e,color:"secondary",icon:(0,o.jsx)(d.G9,{}),label:"Section Input",caption:e.data.remappedId,handles:(0,o.jsx)(a.HH,{type:"source",position:i.Ly.Bottom,isConnectable:e.isConnectable,variant:a.gZ.Data})})}function f(e){return(0,o.jsx)(u.Z,{...e,color:"secondary",icon:(0,o.jsx)(d.k_,{}),label:"Section Output",caption:e.data.outputId,handles:(0,o.jsx)(a.HH,{type:"target",position:i.Ly.Top,isConnectable:e.isConnectable,variant:a.gZ.Data})})}function h(e){return(0,o.jsx)(u.Z,{...e,color:"secondary",icon:(0,o.jsx)(d.hF,{}),label:"Section Buffer",caption:e.data.remappedId,handles:(0,o.jsx)(a.HH,{type:"source",position:i.Ly.Bottom,isConnectable:e.isConnectable,variant:a.gZ.Buffer})})}r()}catch(e){r(e)}})},298:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.kz,{}),label:"Split",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.Data}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Data})]})})}},1465:function(e,t,n){n.d(t,{Z:()=>u});var r=n(4381),o=n(8355),i=n(9849),a=n(7373),s=n(522),l=n(6713);let u=function(e){let{isConnectable:t,sourcePosition:n=a.Ly.Bottom}=e;return(0,r.jsxs)(o.Z,{sx:{minWidth:100},children:[(0,r.jsx)(i.Z,{fullWidth:!0,variant:"outlined",disabled:!0,sx:{width:l.O.nodeWidth,height:l.O.nodeHeight},children:"Start"}),(0,r.jsx)(s.HH,{type:"source",position:n,isConnectable:t,variant:s.gZ.Data})]})}},8338:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.sI,{}),label:"StreamOut",caption:e.data.op.name,handles:(0,r.jsx)(i.HH,{id:i.vH.DataStream,type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.DataStream})})}},6805:function(e,t,n){n.d(t,{Z:()=>u});var r=n(4381),o=n(8355),i=n(9849),a=n(7373),s=n(522),l=n(6713);let u=function(e){let{isConnectable:t,targetPosition:n=a.Ly.Top}=e;return(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(s.HH,{type:"target",position:n,isConnectable:t,variant:s.gZ.Data}),(0,r.jsx)(i.Z,{fullWidth:!0,variant:"outlined",disabled:!0,sx:{width:l.O.nodeWidth,height:l.O.nodeHeight},children:"Terminate"})]})}},7320:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.dY,{}),label:"Transform",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.Data}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Data})]})})}},1565:function(e,t,n){n.d(t,{Z:()=>l});var r=n(4381),o=n(7373),i=n(522),a=n(3970),s=n(4343);let l=function(e){return(0,r.jsx)(a.Z,{...e,icon:(0,r.jsx)(s.Cz,{}),label:"Unzip",handles:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.HH,{type:"target",position:o.Ly.Top,isConnectable:e.isConnectable,variant:i.gZ.Data}),(0,r.jsx)(i.HH,{type:"source",position:o.Ly.Bottom,isConnectable:e.isConnectable,variant:i.gZ.Data})]})})}},8505:function(e,t,n){n.d(t,{D5:()=>c,J5:()=>u,KC:()=>a,bO:()=>l,jG:()=>s,on:()=>o,sw:()=>d,yZ:()=>p});let r=["buffer","buffer_access","fork_clone","fork_result","join","listen","node","scope","section","split","stream_out","transform","unzip"];function o(e){return r.includes(e.type)}let i=["start","terminate"];function a(e){return i.includes(e.type)}function s(e){return"scope"===e.type}function l(e){return"sectionInput"===e.type||"sectionOutput"===e.type||"sectionBuffer"===e.type}function u(e){return"section"===e.type}function d(e){return"sectionInput"===e.type}function c(e){return"sectionOutput"===e.type}function p(e){return"sectionBuffer"===e.type}},6911:function(e,t,n){n.d(t,{j:()=>a,z:()=>i});let r="crossflow-diagram-editor-v1";async function o(e){let{extensions:t,...n}=e,r=JSON.stringify(n),o=new TextEncoder().encode(r);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-1",o))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function i(e,t){e.extensions||(e.extensions={}),e.extensions[r]={hash:await o(e),state:t}}async function a(e){var t;let n=null==(t=e.extensions)?void 0:t[r];return n&&await o(e)===n.hash?n.state:null}},7817:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{c:()=>y,g:()=>h});var o=n(4381),i=n(9229),a=n(4790),s=n(7439),l=n(3749),u=n(36),d=n(4045),c=n(6621),p=e([c]);c=(p.then?(await p)():p)[0];let f=(0,l.createContext)(null),h=e=>{let{children:t}=e,[n,r]=(0,l.useState)(null),[p,h]=(0,l.useState)(!1),[y,m]=(0,l.useState)(null),b=(0,c.m)();return((0,l.useEffect)(()=>{let e=b.getRegistry(),t=(0,u.H)(1e3).pipe((0,d.R)(e)).subscribe(()=>{h(!0)}),n=e.subscribe({next:r,error:e=>{console.error(e),m(e)}});return()=>{t.unsubscribe(),n.unsubscribe()}},[b]),y)?(0,o.jsx)(i.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:(0,o.jsx)(a.Z,{children:"Failed to fetch registry"})}):n?(0,o.jsx)(f.Provider,{value:n,children:t}):p?(0,o.jsx)(i.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:(0,o.jsx)(s.Z,{})}):null},y=()=>{let e=(0,l.useContext)(f);if(!e)throw Error("useRegistry must be used within a RegistryProvider");return e};r()}catch(e){r(e)}})},1913:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{G:()=>O});var o=n(4381),i=n(3961),a=n(7461),s=n(9849),l=n(2682),u=n(5088),d=n(3005),c=n(1150),p=n(8223),f=n(4790),h=n(707),y=n(8694),m=n(3749),b=n(6621),g=n(2854),x=n(3943),_=n(7817),j=n(5065),w=n(9526),v=n(5785),k=n(8182),Z=e([g,b,_,v,x]);[g,b,_,v,x]=Z.then?(await Z)():Z;let C={raw:""};function O(e){let{requestJsonString:t}=e,n=(0,g.zQ)(),r=(0,w.M)(),[Z,O]=(0,m.useState)(!1),S=(0,m.useRef)(null),I=(0,i.Z)(),[$,N]=(0,m.useState)(t),[T,q]=(0,m.useState)(C),E=(0,b.m)(),[D,B]=(0,j.z)(),P=(0,_.c)(),[z,R]=(0,m.useState)(!1),[H,F]=(0,k.L)(),M=(0,m.useMemo)(()=>{try{return JSON.parse($),!1}catch{return!0}},[$]),A=(0,m.useMemo)(()=>"err"in T,[T]),L=(0,m.useMemo)(()=>"err"in T?`Error: ${T.err}`:T.raw,[T]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Z,{title:"Run Workflow",children:(0,o.jsx)(s.Z,{ref:S,onClick:()=>O(!0),children:(0,o.jsx)(x.xk,{symbol:"play_arrow"})})}),(0,o.jsxs)(l.ZP,{open:Z,onClose:()=>{O(!1),q(C)},anchorEl:S.current,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},slotProps:{paper:{sx:{overflow:"visible",mt:.5,backgroundColor:I.palette.background.paper,border:`1px solid ${I.palette.divider}`,"&:before":{content:'""',position:"absolute",top:0,left:"50%",transform:"translateY(-50%) translateX(-50%) rotate(45deg)",width:16,height:16,backgroundColor:I.palette.background.paper,backgroundImage:"inherit",borderTop:`1px solid ${I.palette.divider}`,borderLeft:`1px solid ${I.palette.divider}`}}}},children:[(0,o.jsx)(u.Z,{children:"Run Workflow"}),(0,o.jsx)(d.Z,{}),(0,o.jsx)(c.Z,{sx:{width:500},children:(0,o.jsxs)(p.Z,{spacing:2,children:[(0,o.jsx)(f.Z,{variant:"body1",children:"Request:"}),(0,o.jsx)(h.Z,{fullWidth:!0,multiline:!0,rows:10,variant:"outlined",value:$,slotProps:{htmlInput:{sx:{fontFamily:"monospace",whiteSpace:"nowrap"}}},onChange:e=>N(e.target.value),error:M,sx:{backgroundColor:I.palette.background.paper}}),(0,o.jsxs)(p.Z,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[(0,o.jsx)(f.Z,{variant:"body1",children:"Response:"}),"err"in T?(0,o.jsx)(x.xk,{symbol:"error",sx:{color:I.palette.error.main}}):"raw"in T&&T.raw.length>0?(0,o.jsx)(x.xk,{symbol:"check_circle",sx:{color:I.palette.success.main}}):(0,o.jsx)(o.Fragment,{})]}),(0,o.jsx)(h.Z,{fullWidth:!0,multiline:!0,rows:10,variant:"outlined",value:L,slotProps:{htmlInput:{sx:{fontFamily:"monospace",whiteSpace:"nowrap"}}},error:A})]})}),(0,o.jsx)(y.Z,{children:(0,o.jsx)(s.Z,{variant:"contained",onClick:()=>{try{let e=JSON.parse($),t=(0,v.G)(P,n,r,D,H);E.postRunWorkflow(t,e).subscribe({next:e=>{q({raw:JSON.stringify(e,null,2)}),R(!1)},error:e=>{q({err:e.message}),R(!1)}}),R(!0)}catch(e){q({err:e.message})}},loading:z,startIcon:(0,o.jsx)(x.xk,{symbol:"play_arrow"}),children:"Run"})})]})]})}r()}catch(e){r(e)}})},5065:function(e,t,n){n.d(t,{q:()=>a,z:()=>s});var r=n(4381),o=n(3749);let i=(0,o.createContext)(null);function a(e){let{children:t}=e,[n,a]=(0,o.useState)({});return(0,r.jsx)(i.Provider,{value:[n,a],children:t})}function s(){let e=(0,o.useContext)(i);if(!e)throw Error("useTemplates must be used within a TemplatesProvider");return e}},9526:function(e,t,n){n.d(t,{M:()=>a,w:()=>i});var r=n(3749);let o=(0,r.createContext)([]),i=o.Provider;function a(){return(0,r.useContext)(o)}},5354:function(e,t,n){n.d(t,{J:()=>u});var r=n(742),o=n.n(r),i=n(9804),a=n.n(i),s=JSON.parse('{"$schema":"https://json-schema.org/draft/2020-12/schema","$defs":{"BufferAccessSchema":{"description":"Zip a message together with access to one or more buffers.\\n\\n The receiving node must have an input type of `(Message, Keys)`\\n where `Keys` implements the [`Accessor`][1] trait.\\n\\n [1]: crate::Accessor\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"fork_clone\\",\\n     \\"ops\\": {\\n         \\"fork_clone\\": {\\n             \\"type\\": \\"fork_clone\\",\\n             \\"next\\": [\\"num_output\\", \\"string_output\\"]\\n         },\\n         \\"num_output\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"num_output\\",\\n             \\"next\\": \\"buffer_access\\"\\n         },\\n         \\"string_output\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"string_output\\",\\n             \\"next\\": \\"string_buffer\\"\\n         },\\n         \\"string_buffer\\": {\\n             \\"type\\": \\"buffer\\"\\n         },\\n         \\"buffer_access\\": {\\n             \\"type\\": \\"buffer_access\\",\\n             \\"buffers\\": [\\"string_buffer\\"],\\n             \\"next\\": \\"with_buffer_access\\"\\n         },\\n         \\"with_buffer_access\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"with_buffer_access\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"buffers":{"$ref":"#/$defs/BufferSelection"},"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"$ref":"#/$defs/NextOperation"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["next","buffers"],"type":"object"},"BufferIdentifier":{"anyOf":[{"description":"Identify a buffer by name","type":"string"},{"description":"Identify a buffer by an index value","format":"uint","minimum":0,"type":"integer"}]},"BufferSchema":{"description":"Create a [`Buffer`][1] which can be used to store and pull data within\\n a scope.\\n\\n By default the [`BufferSettings`][2] will keep the single last message\\n pushed to the buffer. You can change that with the optional `settings`\\n property.\\n\\n Use the `\\"serialize\\": true` option to serialize the messages into\\n [`JsonMessage`] before they are inserted into the buffer. This\\n allows any serializable message type to be pushed into the buffer. If\\n left unspecified, the buffer will store the specific data type that gets\\n pushed into it. If the buffer inputs are not being serialized, then all\\n incoming messages being pushed into the buffer must have the same type.\\n\\n [1]: crate::Buffer\\n [2]: crate::BufferSettings\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"fork_clone\\",\\n     \\"ops\\": {\\n         \\"fork_clone\\": {\\n             \\"type\\": \\"fork_clone\\",\\n             \\"next\\": [\\"num_output\\", \\"string_output\\", \\"all_num_buffer\\", \\"serialized_num_buffer\\"]\\n         },\\n         \\"num_output\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"num_output\\",\\n             \\"next\\": \\"buffer_access\\"\\n         },\\n         \\"string_output\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"string_output\\",\\n             \\"next\\": \\"string_buffer\\"\\n         },\\n         \\"string_buffer\\": {\\n             \\"type\\": \\"buffer\\",\\n             \\"settings\\": {\\n                 \\"retention\\": { \\"keep_last\\": 10 }\\n             }\\n         },\\n         \\"all_num_buffer\\": {\\n             \\"type\\": \\"buffer\\",\\n             \\"settings\\": {\\n                 \\"retention\\": \\"keep_all\\"\\n             }\\n         },\\n         \\"serialized_num_buffer\\": {\\n             \\"type\\": \\"buffer\\",\\n             \\"serialize\\": true\\n         },\\n         \\"buffer_access\\": {\\n             \\"type\\": \\"buffer_access\\",\\n             \\"buffers\\": [\\"string_buffer\\"],\\n             \\"next\\": \\"with_buffer_access\\"\\n         },\\n         \\"with_buffer_access\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"with_buffer_access\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"serialize":{"description":"If true, messages will be serialized before sending into the buffer.","type":["boolean","null"]},"settings":{"$ref":"#/$defs/BufferSettings"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"type":"object"},"BufferSelection":{"anyOf":[{"additionalProperties":{"$ref":"#/$defs/NextOperation"},"type":"object"},{"items":{"$ref":"#/$defs/NextOperation"},"type":"array"}]},"BufferSettings":{"description":"Settings to describe the behavior of a buffer.","properties":{"retention":{"$ref":"#/$defs/RetentionPolicy"}},"required":["retention"],"type":"object"},"BuiltinTarget":{"oneOf":[{"const":"terminate","description":"Use the output to terminate the current scope. The value passed into\\n this operation will be the return value of the scope.","type":"string"},{"const":"dispose","description":"Dispose of the output.","type":"string"},{"const":"cancel","description":"When triggered, cancel the current scope. If this is an inner scope of a\\n workflow then the parent scope will see a disposal happen. If this is\\n the root scope of a workflow then the whole workflow will cancel.","type":"string"}]},"ConfigExample":{"properties":{"config":{"description":"The value of the config"},"description":{"description":"A description of what this config is for","type":"string"}},"required":["description","config"],"type":"object"},"DebugSessionMessage":{"oneOf":[{"allOf":[{"oneOf":[{"properties":{"operationStarted":{"type":"string"}},"required":["operationStarted"],"type":"object"}]},{"properties":{"type":{"const":"feedback","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"oneOf":[{"properties":{"ok":true},"required":["ok"],"type":"object"},{"properties":{"err":{"type":"string"}},"required":["err"],"type":"object"}]},{"properties":{"type":{"const":"finish","type":"string"}},"required":["type"],"type":"object"}]}]},"Diagram":{"properties":{"default_trace":{"$ref":"#/$defs/TraceToggle"},"description":{"description":"Optional text to describe the workflow.","type":"string"},"input_examples":{"description":"Examples of inputs that can be used with this workflow.","items":{"$ref":"#/$defs/ExampleInput"},"type":"array"},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"on_implicit_error":{"anyOf":[{"$ref":"#/$defs/NextOperation"},{"type":"null"}]},"ops":{"additionalProperties":{"$ref":"#/$defs/DiagramOperation"},"description":"Operations that define the workflow","type":"object"},"start":{"$ref":"#/$defs/NextOperation"},"templates":{"additionalProperties":{"$ref":"#/$defs/SectionTemplate"},"default":{},"type":"object"},"version":{"description":"Version of the diagram, should always be `0.1.0`.","type":"string"}},"required":["version","start","ops"],"type":"object"},"DiagramElementRegistry":{"properties":{"messages":{"additionalProperties":{"$ref":"#/$defs/MessageRegistration"},"type":"object"},"nodes":{"additionalProperties":{"$ref":"#/$defs/NodeRegistration"},"type":"object"},"schemas":{"additionalProperties":true,"type":"object"},"sections":{"additionalProperties":{"$ref":"#/$defs/SectionRegistration"},"type":"object"},"trace_supported":{"type":"boolean"}},"required":["nodes","sections","trace_supported","messages","schemas"],"type":"object"},"DiagramOperation":{"oneOf":[{"allOf":[{"$ref":"#/$defs/NodeSchema"},{"properties":{"type":{"const":"node","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/SectionSchema"},{"properties":{"type":{"const":"section","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/ScopeSchema"},{"properties":{"type":{"const":"scope","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/StreamOutSchema"},{"properties":{"type":{"const":"stream_out","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/ForkCloneSchema"},{"properties":{"type":{"const":"fork_clone","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/UnzipSchema"},{"properties":{"type":{"const":"unzip","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/ForkResultSchema"},{"properties":{"type":{"const":"fork_result","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/SplitSchema"},{"properties":{"type":{"const":"split","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/JoinSchema"},{"properties":{"type":{"const":"join","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/TransformSchema"},{"properties":{"type":{"const":"transform","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/BufferSchema"},{"properties":{"type":{"const":"buffer","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/BufferAccessSchema"},{"properties":{"type":{"const":"buffer_access","type":"string"}},"required":["type"],"type":"object"}]},{"allOf":[{"$ref":"#/$defs/ListenSchema"},{"properties":{"type":{"const":"listen","type":"string"}},"required":["type"],"type":"object"}]}]},"ExampleInput":{"properties":{"description":{"type":"string"},"value":true},"required":["value","description"],"type":"object"},"ForkCloneSchema":{"description":"If the request is cloneable, clone it into multiple responses that can\\n each be sent to a different operation. The `next` property is an array.\\n\\n This creates multiple simultaneous branches of execution within the\\n workflow. Usually when you have multiple branches you will either\\n * race - connect all branches to `terminate` and the first branch to\\n   finish \\"wins\\" the race and gets to the be output\\n * join - connect each branch into a buffer and then use the `join`\\n   operation to reunite them\\n * collect - TODO(@mxgrey): [add the collect operation](https://github.com/open-rmf/crossflow/issues/59)\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"begin_race\\",\\n     \\"ops\\": {\\n         \\"begin_race\\": {\\n             \\"type\\": \\"fork_clone\\",\\n             \\"next\\": [\\n                 \\"ferrari\\",\\n                 \\"mustang\\"\\n             ]\\n         },\\n         \\"ferrari\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"drive\\",\\n             \\"config\\": \\"ferrari\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         },\\n         \\"mustang\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"drive\\",\\n             \\"config\\": \\"mustang\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())","properties":{"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"items":{"$ref":"#/$defs/NextOperation"},"type":"array"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["next"],"type":"object"},"ForkResultSchema":{"description":"If the request is a [`Result<T, E>`], send the output message down an\\n `ok` branch or down an `err` branch depending on whether the result has\\n an [`Ok`] or [`Err`] value. The `ok` branch will receive a `T` while the\\n `err` branch will receive an `E`.\\n\\n Only one branch will be activated by each input message that enters the\\n operation.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"fork_result\\",\\n     \\"ops\\": {\\n         \\"fork_result\\": {\\n             \\"type\\": \\"fork_result\\",\\n             \\"ok\\": { \\"builtin\\": \\"terminate\\" },\\n             \\"err\\": { \\"builtin\\": \\"dispose\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"err":{"$ref":"#/$defs/NextOperation"},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"ok":{"$ref":"#/$defs/NextOperation"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["ok","err"],"type":"object"},"InputRemapping":{"anyOf":[{"description":"Do a simple 1:1 forwarding of the names listed in the array","items":{"type":"string"},"type":"array"},{"additionalProperties":{"$ref":"#/$defs/NextOperation"},"description":"Rename an operation inside the section to expose it externally. The key\\n of the map is what siblings of the section can connect to, and the value\\n of the entry is the identifier of the input inside the section that is\\n being exposed.\\n\\n This allows a section to expose inputs and buffers that are provided\\n by inner sections.","type":"object"}]},"JoinSchema":{"description":"Wait for exactly one item to be available in each buffer listed in\\n `buffers`, then join each of those items into a single output message\\n that gets sent to `next`.\\n\\n If the `next` operation is not a `node` type (e.g. `fork_clone`) then\\n you must specify a `target_node` so that the diagram knows what data\\n structure to join the values into.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"begin_measuring\\",\\n     \\"ops\\": {\\n         \\"begin_measuring\\": {\\n             \\"type\\": \\"fork_clone\\",\\n             \\"next\\": [\\"localize\\", \\"imu\\"]\\n         },\\n         \\"localize\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"localize\\",\\n             \\"next\\": \\"estimated_position\\"\\n         },\\n         \\"imu\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"imu\\",\\n             \\"config\\": \\"velocity\\",\\n             \\"next\\": \\"estimated_velocity\\"\\n         },\\n         \\"estimated_position\\": { \\"type\\": \\"buffer\\" },\\n         \\"estimated_velocity\\": { \\"type\\": \\"buffer\\" },\\n         \\"gather_state\\": {\\n             \\"type\\": \\"join\\",\\n             \\"buffers\\": {\\n                 \\"position\\": \\"estimate_position\\",\\n                 \\"velocity\\": \\"estimate_velocity\\"\\n             },\\n             \\"next\\": \\"report_state\\"\\n         },\\n         \\"report_state\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"publish_state\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"buffers":{"$ref":"#/$defs/BufferSelection"},"clone":{"description":"List of the keys in the `buffers` dictionary whose value should be cloned\\n instead of removed from the buffer (pulled) when the join occurs. Cloning\\n the value will leave the buffer unchanged after the join operation takes\\n place.","items":{"$ref":"#/$defs/BufferIdentifier"},"type":"array"},"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"$ref":"#/$defs/NextOperation"},"serialize":{"description":"Whether or not to automatically serialize the inputs into a single JsonMessage.\\n This will only work if all input types are serializable, otherwise you will\\n get a [`DiagramError`][super::DiagramError].","type":"boolean"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["next","buffers"],"type":"object"},"ListenSchema":{"description":"Listen on a buffer.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"num_output\\",\\n     \\"ops\\": {\\n         \\"buffer\\": {\\n             \\"type\\": \\"buffer\\"\\n         },\\n         \\"num_output\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"num_output\\",\\n             \\"next\\": \\"buffer\\"\\n         },\\n         \\"listen\\": {\\n             \\"type\\": \\"listen\\",\\n             \\"buffers\\": [\\"buffer\\"],\\n             \\"next\\": \\"listen_buffer\\"\\n         },\\n         \\"listen_buffer\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"listen_buffer\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())","properties":{"buffers":{"$ref":"#/$defs/BufferSelection"},"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"$ref":"#/$defs/NextOperation"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["next","buffers"],"type":"object"},"MessageOperation":{"properties":{"deserialize":{"type":["object","null"]},"fork_clone":{"type":["object","null"]},"fork_result":{"type":["object","null"]},"join":{"type":["object","null"]},"serialize":{"type":["object","null"]},"split":{"type":["object","null"]},"unzip":{"items":{"type":"string"},"type":["array","null"]}},"type":"object"},"MessageRegistration":{"properties":{"operations":{"$ref":"#/$defs/MessageOperation"},"schema":{"anyOf":[{"$ref":"#/$defs/Schema"},{"type":"null"}]},"type_name":{"type":"string"}},"required":["type_name","operations"],"type":"object"},"NamespacedOperation":{"additionalProperties":{"type":"string"},"description":"Refer to an operation inside of a namespace, e.g. { \\"<namespace>\\": \\"<operation>\\"","maxProperties":1,"minProperties":1,"title":"NamespacedOperation","type":"object"},"NextOperation":{"anyOf":[{"type":"string"},{"properties":{"builtin":{"$ref":"#/$defs/BuiltinTarget"}},"required":["builtin"],"type":"object"},{"$ref":"#/$defs/NamespacedOperation"}]},"NodeRegistration":{"properties":{"config_schema":{"$ref":"#/$defs/Schema"},"default_display_text":{"description":"If the user does not specify a default display text, the node ID will\\n be used here.","type":"string"},"description":{"type":["string","null"]},"config_examples":{"items":{"$ref":"#/$defs/ConfigExample"},"type":"array"},"request":{"type":"string"},"response":{"type":"string"},"streams":{"additionalProperties":{"type":"string"},"type":"object"}},"required":["default_display_text","request","response","streams","config_schema","config_examples"],"type":"object"},"NodeSchema":{"description":"Create an operation that that takes an input message and produces an\\n output message.\\n\\n The behavior is determined by the choice of node `builder` and\\n optionally the `config` that you provide. Each type of node builder has\\n its own schema for the config.\\n\\n The output message will be sent to the operation specified by `next`.\\n\\n TODO(@mxgrey): [Support stream outputs](https://github.com/open-rmf/crossflow/issues/43)\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"cutting_board\\",\\n     \\"ops\\": {\\n         \\"cutting_board\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"chop\\",\\n             \\"config\\": \\"diced\\",\\n             \\"next\\": \\"bowl\\"\\n         },\\n         \\"bowl\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"stir\\",\\n             \\"next\\": \\"oven\\"\\n         },\\n         \\"oven\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"bake\\",\\n             \\"config\\": {\\n                 \\"temperature\\": 200,\\n                 \\"duration\\": 120\\n             },\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())","properties":{"builder":{"type":"string"},"config":true,"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"$ref":"#/$defs/NextOperation"},"stream_out":{"additionalProperties":{"$ref":"#/$defs/NextOperation"},"type":"object"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["builder","next"],"type":"object"},"PostRunRequest":{"properties":{"diagram":{"$ref":"#/$defs/Diagram"},"request":true},"required":["diagram","request"],"type":"object"},"RetentionPolicy":{"oneOf":[{"additionalProperties":false,"description":"Keep the last N items that were stored into the buffer. Once the limit\\n is reached, the oldest item will be removed any time a new item arrives.","properties":{"keep_last":{"format":"uint","minimum":0,"type":"integer"}},"required":["keep_last"],"type":"object"},{"additionalProperties":false,"description":"Keep the first N items that are stored into the buffer. Once the limit\\n is reached, any new item that arrives will be discarded.","properties":{"keep_first":{"format":"uint","minimum":0,"type":"integer"}},"required":["keep_first"],"type":"object"},{"const":"keep_all","description":"Do not limit how many items can be stored in the buffer.","type":"string"}]},"Schema":{"type":["object","boolean"]},"ScopeSchema":{"description":"Create a scope which will function like its own encapsulated workflow\\n within the paren workflow. Each message that enters a scope will trigger\\n a new independent session for that scope to begin running with the incoming\\n message itself being the input message of the scope. When multiple sessions\\n for the same scope are running, they cannot see or interfere with each other.\\n\\n Once a session terminates, the scope will send the terminating message as\\n its output. Scopes can use the `stream_out` operation to stream messages out\\n to the parent workflow while running.\\n\\n Scopes have two common uses:\\n * isolate - Prevent simultaneous runs of the same workflow components\\n   (especially buffers) from interfering with each other.\\n * race - Run multiple branches simultaneously inside the scope and race\\n   them against each ohter. The first branch that reaches the scope\'s\\n   terminate operation \\"wins\\" the race, and only its output will continue\\n   on in the parent workflow. All other branches will be disposed.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"approach_door\\",\\n     \\"ops\\": {\\n         \\"approach_door\\": {\\n             \\"type\\": \\"scope\\",\\n             \\"start\\": \\"begin\\",\\n             \\"ops\\": {\\n                 \\"begin\\": {\\n                     \\"type\\": \\"fork_clone\\",\\n                     \\"next\\": [\\n                         \\"move_to_door\\",\\n                         \\"detect_door_proximity\\"\\n                     ]\\n                 },\\n                 \\"move_to_door\\": {\\n                     \\"type\\": \\"node\\",\\n                     \\"builder\\": \\"move\\",\\n                     \\"config\\": {\\n                         \\"place\\": \\"L1_north_lobby_outside\\"\\n                     },\\n                     \\"next\\": { \\"builtin\\" : \\"terminate\\" }\\n                 },\\n                 \\"detect_proximity\\": {\\n                     \\"type\\": \\"node\\",\\n                     \\"builder\\": \\"detect_proximity\\",\\n                     \\"config\\": {\\n                         \\"type\\": \\"door\\",\\n                         \\"name\\": \\"L1_north_lobby\\"\\n                     },\\n                     \\"next\\": { \\"builtin\\" : \\"terminate\\" }\\n                 }\\n             },\\n             \\"next\\": { \\"builtin\\" : \\"try_open_door\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"$ref":"#/$defs/NextOperation"},"on_implicit_error":{"anyOf":[{"$ref":"#/$defs/NextOperation"},{"type":"null"}]},"ops":{"additionalProperties":{"$ref":"#/$defs/DiagramOperation"},"description":"Operations that exist inside this scope.","type":"object"},"settings":{"$ref":"#/$defs/ScopeSettings"},"start":{"$ref":"#/$defs/NextOperation"},"stream_out":{"additionalProperties":{"$ref":"#/$defs/NextOperation"},"default":{},"description":"Where to connect streams that are coming out of this scope.","type":"object"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["start","ops","next"],"type":"object"},"ScopeSettings":{"description":"Settings which determine how the top-level scope of the workflow behaves.","properties":{"uninterruptible":{"description":"Should we prevent the scope from being interrupted (e.g. cancelled)?\\n False by default, meaning by default scopes can be cancelled or\\n interrupted.","type":"boolean"}},"required":["uninterruptible"],"type":"object"},"SectionBuffer":{"properties":{"item_type":{"type":["string","null"]}},"type":"object"},"SectionInput":{"properties":{"message_type":{"type":"string"}},"required":["message_type"],"type":"object"},"SectionMetadata":{"properties":{"buffers":{"additionalProperties":{"$ref":"#/$defs/SectionBuffer"},"type":"object"},"inputs":{"additionalProperties":{"$ref":"#/$defs/SectionInput"},"type":"object"},"outputs":{"additionalProperties":{"$ref":"#/$defs/SectionOutput"},"type":"object"}},"required":["inputs","outputs","buffers"],"type":"object"},"SectionOutput":{"properties":{"message_type":{"type":"string"}},"required":["message_type"],"type":"object"},"SectionRegistration":{"properties":{"config_schema":{"$ref":"#/$defs/Schema"},"default_display_text":{"type":"string"},"description":{"type":["string","null"]},"config_examples":{"items":{"$ref":"#/$defs/ConfigExample"},"type":"array"},"metadata":{"$ref":"#/$defs/SectionMetadata"}},"required":["default_display_text","metadata","config_schema","config_examples"],"type":"object"},"SectionSchema":{"allOf":[{"oneOf":[{"properties":{"builder":{"type":"string"}},"required":["builder"],"type":"object"},{"properties":{"template":{"type":"string"}},"required":["template"],"type":"object"}]},{"description":"Connect the request to a registered section.\\n\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"section_op\\",\\n     \\"ops\\": {\\n         \\"section_op\\": {\\n             \\"type\\": \\"section\\",\\n             \\"builder\\": \\"my_section_builder\\",\\n             \\"connect\\": {\\n                 \\"my_section_output\\": { \\"builtin\\": \\"terminate\\" }\\n             }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```\\n\\n Custom sections can also be created via templates\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"templates\\": {\\n         \\"my_template\\": {\\n             \\"inputs\\": [\\"section_input\\"],\\n             \\"outputs\\": [\\"section_output\\"],\\n             \\"buffers\\": [],\\n             \\"ops\\": {\\n                 \\"section_input\\": {\\n                     \\"type\\": \\"node\\",\\n                     \\"builder\\": \\"my_node\\",\\n                     \\"next\\": \\"section_output\\"\\n                 }\\n             }\\n         }\\n     },\\n     \\"start\\": \\"section_op\\",\\n     \\"ops\\": {\\n         \\"section_op\\": {\\n             \\"type\\": \\"section\\",\\n             \\"template\\": \\"my_template\\",\\n             \\"connect\\": {\\n                 \\"section_output\\": { \\"builtin\\": \\"terminate\\" }\\n             }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"config":{"default":null},"connect":{"additionalProperties":{"$ref":"#/$defs/NextOperation"},"default":{},"type":"object"},"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"type":"object"}]},"SectionTemplate":{"properties":{"buffers":{"$ref":"#/$defs/InputRemapping"},"inputs":{"$ref":"#/$defs/InputRemapping"},"ops":{"additionalProperties":{"$ref":"#/$defs/DiagramOperation"},"description":"Operations that define the behavior of the section.","type":"object"},"outputs":{"default":[],"description":"These are the outputs that the section is exposing so you can connect\\n them into siblings of the section.","items":{"type":"string"},"type":"array"}},"required":["ops"],"type":"object"},"SplitSchema":{"description":"If the input message is a list-like or map-like object, split it into\\n multiple output messages.\\n\\n Note that the type of output message from the split depends on how the\\n input message implements the [`Splittable`][1] trait. In many cases this\\n will be a tuple of `(key, value)`.\\n\\n There are three ways to specify where the split output messages should\\n go, and all can be used at the same time:\\n * `sequential` - For array-like collections, send the \\"first\\" element of\\n   the collection to the first operation listed in the `sequential` array.\\n   The \\"second\\" element of the collection goes to the second operation\\n   listed in the `sequential` array. And so on for all elements in the\\n   collection. If one of the elements in the collection is mentioned in\\n   the `keyed` set, then the sequence will pass over it as if the element\\n   does not exist at all.\\n * `keyed` - For map-like collections, send the split element associated\\n   with the specified key to its associated output.\\n * `remaining` - Any elements that are were not captured by `sequential`\\n   or by `keyed` will be sent to this.\\n\\n [1]: crate::Splittable\\n\\n # Examples\\n\\n Suppose I am an animal rescuer sorting through a new collection of\\n animals that need recuing. My home has space for three exotic animals\\n plus any number of dogs and cats.\\n\\n I have a custom `SpeciesCollection` data structure that implements\\n [`Splittable`][1] by allowing you to key on the type of animal.\\n\\n In the workflow below, we send all cats and dogs to `home`, and we also\\n send the first three non-dog and non-cat species to `home`. All\\n remaining animals go to the zoo.\\n\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"select_animals\\",\\n     \\"ops\\": {\\n         \\"select_animals\\": {\\n             \\"type\\": \\"split\\",\\n             \\"sequential\\": [\\n                 \\"home\\",\\n                 \\"home\\",\\n                 \\"home\\"\\n             ],\\n             \\"keyed\\": {\\n                 \\"cat\\": \\"home\\",\\n                 \\"dog\\": \\"home\\"\\n             },\\n             \\"remaining\\": \\"zoo\\"\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```\\n\\n If we input `[\\"frog\\", \\"cat\\", \\"bear\\", \\"beaver\\", \\"dog\\", \\"rabbit\\", \\"dog\\", \\"monkey\\"]`\\n then `frog`, `bear`, and `beaver` will be sent to `home` since those are\\n the first three animals that are not `dog` or `cat`, and we will also\\n send one `cat` and two `dog` home. `rabbit` and `monkey` will be sent to the zoo.","properties":{"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"keyed":{"additionalProperties":{"$ref":"#/$defs/NextOperation"},"type":"object"},"remaining":{"anyOf":[{"$ref":"#/$defs/NextOperation"},{"type":"null"}]},"sequential":{"items":{"$ref":"#/$defs/NextOperation"},"type":"array"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"type":"object"},"StreamOutSchema":{"description":"Declare a stream output for the current scope. Outputs that you connect\\n to this operation will be streamed out of the scope that this operation\\n is declared in.\\n\\n For the root-level scope, make sure you use a stream pack that is\\n compatible with all stream out operations that you declare, otherwise\\n you may get a connection error at runtime.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"plan\\",\\n     \\"ops\\": {\\n         \\"progress_stream\\": {\\n             \\"type\\": \\"stream_out\\",\\n             \\"name\\": \\"progress\\"\\n         },\\n         \\"plan\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"planner\\",\\n             \\"next\\": \\"drive\\",\\n             \\"stream_out\\" : {\\n                 \\"progress\\": \\"progress_stream\\"\\n             }\\n         },\\n         \\"drive\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"navigation\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" },\\n             \\"stream_out\\": {\\n                 \\"progress\\": \\"progress_stream\\"\\n             }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"name":{"description":"The name of the stream exiting the workflow or scope.","type":"string"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["name"],"type":"object"},"TraceToggle":{"oneOf":[{"const":"off","description":"Do not emit any signal when the operation is activated.","type":"string"},{"const":"on","description":"Emit a minimal signal with just the operation information when the\\n operation is activated.","type":"string"},{"const":"messages","description":"Emit a signal that includes a serialized copy of the message when the\\n operation is activated. This may substantially increase the overhead of\\n triggering operations depending on the size and frequency of the messages,\\n so it is recommended only for high-level workflows or for debugging.\\n\\n If the message is not serializable then it will simply not be included\\n in the event information.","type":"string"}]},"TransformSchema":{"description":"If the request is serializable, transform it by running it through a [CEL](https://cel.dev/) program.\\n The context includes a \\"request\\" variable which contains the input message.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"transform\\",\\n     \\"ops\\": {\\n         \\"transform\\": {\\n             \\"type\\": \\"transform\\",\\n             \\"cel\\": \\"request.name\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```\\n\\n Note that due to how `serde_json` performs serialization, positive integers are always\\n serialized as unsigned. In CEL, You can\'t do an operation between unsigned and signed so\\n it is recommended to always perform explicit casts.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"transform\\",\\n     \\"ops\\": {\\n         \\"transform\\": {\\n             \\"type\\": \\"transform\\",\\n             \\"cel\\": \\"int(request.score) * 3\\",\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"cel":{"type":"string"},"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"$ref":"#/$defs/NextOperation"},"on_error":{"anyOf":[{"$ref":"#/$defs/NextOperation"},{"type":"null"}]},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["cel","next"],"type":"object"},"UnzipSchema":{"description":"If the input message is a tuple of (T1, T2, T3, ...), unzip it into\\n multiple output messages of T1, T2, T3, ...\\n\\n Each output message may have a different type and can be sent to a\\n different operation. This creates multiple simultaneous branches of\\n execution within the workflow. See [`DiagramOperation::ForkClone`] for\\n more information on parallel branches.\\n\\n # Examples\\n ```\\n # crossflow::Diagram::from_json_str(r#\\"\\n {\\n     \\"version\\": \\"0.1.0\\",\\n     \\"start\\": \\"name_phone_address\\",\\n     \\"ops\\": {\\n         \\"name_phone_address\\": {\\n             \\"type\\": \\"unzip\\",\\n             \\"next\\": [\\n                 \\"process_name\\",\\n                 \\"process_phone_number\\",\\n                 \\"process_address\\"\\n             ]\\n         },\\n         \\"process_name\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"process_name\\",\\n             \\"next\\": \\"name_processed\\"\\n         },\\n         \\"process_phone_number\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"process_phone_number\\",\\n             \\"next\\": \\"phone_number_processed\\"\\n         },\\n         \\"process_address\\": {\\n             \\"type\\": \\"node\\",\\n             \\"builder\\": \\"process_address\\",\\n             \\"next\\": \\"address_processed\\"\\n         },\\n         \\"name_processed\\": { \\"type\\": \\"buffer\\" },\\n         \\"phone_number_processed\\": { \\"type\\": \\"buffer\\" },\\n         \\"address_processed\\": { \\"type\\": \\"buffer\\" },\\n         \\"finished\\": {\\n             \\"type\\": \\"join\\",\\n             \\"buffers\\": [\\n                 \\"name_processed\\",\\n                 \\"phone_number_processed\\",\\n                 \\"address_processed\\"\\n             ],\\n             \\"next\\": { \\"builtin\\": \\"terminate\\" }\\n         }\\n     }\\n }\\n # \\"#)?;\\n # Ok::<_, serde_json::Error>(())\\n ```","properties":{"display_text":{"description":"Override for text that should be displayed for an operation within an\\n editor.","type":["string","null"]},"extensions":{"additionalProperties":true,"default":{},"description":"Settings for each extension.","type":"object"},"next":{"items":{"$ref":"#/$defs/NextOperation"},"type":"array"},"trace":{"anyOf":[{"$ref":"#/$defs/TraceToggle"},{"type":"null"}]}},"required":["next"],"type":"object"}}}');let l=a()(new(o())({allowUnionTypes:!0})).addFormat("uint",/^[0-9]+$/);function u(e){let t=l.getSchema(`#/$defs/${e}`);if(!t)throw Error(`cannot validate ${e}`);return t}l.compile(s)},8322:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{M:()=>c});var o=n(4767),i=n(2854),a=n(3943),s=n(6713),l=n(4187),u=e([i,a]);function d(e){return"scope"===e.type}function c(e,t,n){let r=new i.Bl(e),u=new o.graphlib.Graph().setDefaultEdgeLabel(()=>({}));u.setGraph({rankdir:"TB",ranksep:n.nodeHeight});let c={};for(let t of e){let e=t.parentId?r.tryGetNode(t.parentId):null;(null==e?void 0:e.id)&&(c[e.id]||(c[e.id]=[]),c[e.id].push(t)),d(t)||u.setNode(t.id,{width:n.nodeWidth,height:n.nodeHeight})}let p=[[],[]];for(let e of t)switch(e.type){case"streamOut":case"forkResultErr":p[1].push(e);break;default:p[0].push(e)}for(let e of p.flat()){let t=r.getNode(e.source),n=r.getNode(e.target);"scope"===n.type?u.setEdge(e.source,r.getNodeFromNamespaceOpId((0,l.Tz)(n.data.namespace,n.data.opId),a.M8).id,{minlen:2}):"scope"===t.type?u.setEdge(r.getNodeFromNamespaceOpId((0,l.Tz)(t.data.namespace,t.data.opId),a.fc).id,e.target,{minlen:2}):u.setEdge(e.source,e.target)}o.layout(u);let f={};for(let[e,t]of Object.entries(c))f[e]=(0,s.e)(t.map(e=>u.node(e.id)));let h=[];for(let t of e){let e=u.node(t.id);if(!d(t))if(t.parentId){let n=f[t.parentId];h.push({type:"position",id:t.id,position:{x:e.x-n.x,y:e.y-n.y}})}else h.push({type:"position",id:t.id,position:{x:e.x,y:e.y}})}for(let[e,t]of Object.entries(f))h.push({type:"position",id:e,position:{x:t.x,y:t.y}}),h.push({type:"dimensions",id:e,dimensions:{width:t.width,height:t.height},setAttributes:!0});return h}[i,a]=u.then?(await u)():u,r()}catch(e){r(e)}})},1275:function(e,t,n){n.d(t,{L:()=>r});function r(e){return"string"==typeof e?"keep_all":Object.keys(e)[0]}},4163:function(e,t,n){n.d(t,{t:()=>r});function r(e){return"remove"===e.type}},2111:function(e,t,n){n.d(t,{M9:()=>p,b0:()=>y,oE:()=>h});var r=n(6113),o=n(522),i=n(106);let a={buffer:["buffer"],buffer_access:["default"],fork_clone:["default"],fork_result:["forkResultOk","forkResultErr"],join:["default"],listen:["default"],node:["default","streamOut"],scope:["default","streamOut"],section:["section"],sectionInput:["default"],sectionOutput:[],sectionBuffer:["buffer"],split:["splitKey","splitSeq","splitRemaining"],start:["default"],stream_out:[],terminate:[],transform:["default"],unzip:["unzip"]},s={buffer:[r.Cn.Data],buffer_access:[r.Cn.Data,r.Cn.Buffer],fork_clone:[r.Cn.Data],fork_result:[r.Cn.Data],join:[r.Cn.Buffer],listen:[r.Cn.Buffer],node:[r.Cn.Data],scope:[r.Cn.Data],section:[r.Cn.Data,r.Cn.Buffer],sectionInput:[],sectionOutput:[r.Cn.Data],sectionBuffer:[],split:[r.Cn.Data],start:[],stream_out:[r.Cn.Data],terminate:[r.Cn.Data],transform:[r.Cn.Data],unzip:[r.Cn.Data]},l={dataStream:["streamOut"],forkResultOk:["forkResultOk"],forkResultErr:["forkResultErr"]},u=["streamOut"],d={dataStream:[r.Cn.Data],forkResultOk:[],forkResultErr:[]};function c(e,t){let n=[];for(let r of e)t.includes(r)&&n.push(r);return n}function p(e,t,n,o){let i=a[e.type];if(t){let e=l[t];e?i=c(i,e):console.error("failed to get allowed handle output edges")}else i=function(e,t){let n=[];for(let r of e)t.includes(r)||n.push(r);return n}(i,u);let p=s[n.type];if(o){let e=d[o];e?p=c(p,e):console.error("failed to get allowed handle input edge categories")}return Array.from(i).filter(e=>p.includes(r.Do[e]))}function f(e){return{valid:!1,error:e}}function h(e,t){let n=t.tryGetNode(e.source),r=t.tryGetNode(e.target);return n&&r?(n.parentId||r.parentId)&&n.parentId!==r.parentId?f("source and target nodes are in different sections"):0===p(n,e.sourceHandle,r,e.targetHandle).length?f("no valid edge type"):{valid:!0}:f("cannot find source or target node")}function y(e,t,n){let a=function(e,t){let n=t.tryGetNode(e.source),r=t.tryGetNode(e.target);if(!n||!r)return f("cannot find source or target node");let o=p(n,e.sourceHandle,r,e.targetHandle);return o.includes(e.type)?{valid:!0,validEdgeTypes:o}:f("invalid edge type")}(e,t);if(!a.valid)return a;let s=t.tryGetNode(e.source),l=t.tryGetNode(e.target);if(!s||!l)return f("cannot find source or target node");if("section"===l.type){if(r.Do[e.type]===r.Cn.Buffer&&"sectionBuffer"!==e.data.input.type)return f("target is a section but there is no input slot");else if(r.Do[e.type]===r.Cn.Data&&"sectionInput"!==e.data.input.type)return f("target is a section but there is no input slot")}let u=function(e,t){if(t===o.vH.DataStream)return 0;switch(e){case"fork_clone":case"unzip":case"buffer":case"section":case"split":return 2;case"fork_result":case"node":case"buffer_access":case"join":case"listen":case"scope":case"stream_out":case"transform":case"start":case"terminate":case"sectionBuffer":case"sectionInput":case"sectionOutput":return 0;default:throw(0,i.y)(e),Error("unknown op type")}}(s.type,e.sourceHandle);switch(u){case 0:if(n.some(t=>t.source===s.id&&(e.sourceHandle||null)===(t.sourceHandle||null)&&e.id!==t.id))return f("This output can only be connected to one input");break;case 1:{let t=0;for(let r of n)if(r.source===s.id&&e.id!==r.id&&t++,t>1)return f("This output can only be connected to two inputs");break}case 2:break;default:throw(0,i.y)(u),Error("unknown output cardinality")}return{valid:!0,validEdgeTypes:a.validEdgeTypes}}},106:function(e,t,n){n.d(t,{y:()=>r});function r(e){}},5785:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{G:()=>b,W:()=>g});var o=n(5490),i=n.n(o),a=n(6113),s=n(3943),l=n(106),u=n(4187),d=n(1692),c=e([d,s]);function p(e,t){let n=(0,u.rT)(t),r=e;for(let e of n.slice(1)){let t=r.ops[e];if(!t||"scope"!==t.type)throw Error(`expected ${e} to be a scope operation`);r=t}return r}function f(e,t,n){t.stream_out=t.stream_out?t.stream_out:{},t.stream_out[n.data.output.streamId]=e.getTargetNextOp(n)}function h(e,t){switch(e.type){case"buffer_access":case"listen":case"join":e.buffers=t;break;default:throw Error(`"${e.type}" operation does not accept a buffer`)}}function y(e,t,n,r){for(let e of(n.start={builtin:"dispose"},t.iterNodes()))switch(e.type){case"node":e.data.op.next={builtin:"dispose"},delete e.data.op.stream_out;break;case"scope":e.data.op.next={builtin:"dispose"},delete e.data.op.stream_out,e.data.op.start={builtin:"dispose"};break;case"fork_clone":case"unzip":e.data.op.next=[];break;case"transform":e.data.op.next={builtin:"dispose"};break;case"join":e.data.op.next={builtin:"dispose"},e.data.op.buffers=[],delete e.data.op.clone;break;case"listen":case"buffer_access":e.data.op.next={builtin:"dispose"},e.data.op.buffers=[];break;case"section":e.data.op.connect={};break;case"fork_result":e.data.op.ok={builtin:"dispose"},e.data.op.err={builtin:"dispose"};break;case"split":delete e.data.op.keyed,delete e.data.op.sequential,delete e.data.op.remaining;break;case"buffer":case"stream_out":case"sectionOutput":case"start":case"terminate":break;case"sectionInput":case"sectionBuffer":e.data.targetId={builtin:"dispose"};break;default:(0,l.y)(e)}for(let o of r.filter(n=>{if("streamOut"===n.type){let r=t.getNode(n.source),o=(0,s.on)(r)&&"node"===r.data.op.type?e.nodes[r.data.op.builder]:null;return null!=o&&!!o.streams&&Object.keys(o.streams).length>0}return!0}))!function(e,t,n){if("buffer"===n.type)return function(e,t){if("buffer"===t.type){var n,r,o,i,l,u;let c=e.getNode(t.target);if(!(0,s.on)(c))throw Error("expected operation node");let p=c.data.op;if(!p)throw Error(`target operation "${t.target}" not found`);let f=function(e){switch(e.type){case"buffer_access":case"listen":case"join":return e.buffers;default:throw Error(`"${e.type}" operation does not accept a buffer`)}}(p);(null==(n=t.data.input)?void 0:n.type)==="bufferKey"&&Array.isArray(f)&&0===f.length?(f={},h(p,f)):(null==(r=t.data.input)?void 0:r.type)!=="bufferSeq"||"object"!=typeof f||Array.isArray(f)||0!==Object.keys(f).length||(f=[],h(p,f));let y=e.getNode(t.source);if("buffer"!==y.type)throw Error("expected source to be a buffer node");if("buffer"===t.type&&(null==(o=t.data.input)?void 0:o.type)==="bufferSeq"){if(!(0,d.Il)(f))throw Error("a sequential buffer edge must be assigned to an array of buffers");f[t.data.input.seq]=y.data.opId}if("buffer"===t.type&&(null==(i=t.data.input)?void 0:i.type)==="bufferKey"){if(!(0,d.kY)(f))throw Error("a keyed buffer edge must be assigned to a keyed buffer selection");f[t.data.input.key]=y.data.opId}"join"===p.type&&t.data.input.fetchType===a.fe.Clone&&(p.clone||(p.clone=[]),(null==(l=t.data.input)?void 0:l.type)==="bufferSeq"&&p.clone.push(t.data.input.seq),(null==(u=t.data.input)?void 0:u.type)==="bufferKey"&&p.clone.push(t.data.input.key))}}(e,n);let r=e.getNode(n.source);if((0,s.on)(r)){let t=r.data.op;switch(t.type){case"node":"streamOut"===n.type?f(e,t,n):"default"===n.type&&(t.next=e.getTargetNextOp(n));break;case"join":case"transform":case"buffer_access":case"listen":if("default"!==n.type)throw Error('expected "default" edge');t.next=e.getTargetNextOp(n);break;case"section":if("section"!==n.type)throw Error("expected section edge");t.connect||(t.connect={}),t.connect[n.data.output.output]=e.getTargetNextOp(n);break;case"fork_clone":{if("default"!==n.type)throw Error('expected "default" edge');let r=e.getTargetNextOp(n);t.next.some(e=>i()(e,r))||t.next.push(r);break}case"unzip":if("unzip"!==n.type)throw Error('expected "unzip" edge');t.next[n.data.output.seq]=e.getTargetNextOp(n);break;case"fork_result":switch(n.type){case"forkResultOk":t.ok=e.getTargetNextOp(n);break;case"forkResultErr":t.err=e.getTargetNextOp(n);break;default:throw Error('fork_result operation must have "ok" or "err" edge')}break;case"split":switch(n.type){case"splitKey":t.keyed||(t.keyed={}),t.keyed[n.data.output.key]=e.getTargetNextOp(n);break;case"splitSeq":{t.sequential||(t.sequential=[]);let r=e.getTargetNextOp(n);for(var o=t.sequential,u=n.data.output.seq;o.length<=u;)o.push({builtin:"dispose"});o[u]=r;break}case"splitRemaining":t.remaining=e.getTargetNextOp(n);break;default:throw Error('split operation must have "SplitKey", "SplitSequential", or "SplitRemaining" edge')}break;case"buffer":throw Error("buffer operations cannot have connections");case"scope":if("streamOut"===n.type)f(e,t,n);else if("default"!==n.type)throw Error("scope operation must have default or streamOut edge");t.next=e.getTargetNextOp(n);break;case"stream_out":break;default:throw(0,l.y)(t),Error("unknown operation type")}}else"start"===r.type?(()=>{if(!r.parentId)return t;let n=e.getNode(r.parentId);if(!(0,s.jG)(n))throw Error("expected parent to be a scope node");return n.data.op})().start=e.getTargetNextOp(n):("sectionInput"===r.type||"sectionBuffer"===r.type)&&(r.data.targetId=e.getTargetNextOp(n))}(t,n,o)}function m(e){return(0,s.KC)(e)||(0,s.on)(e)?(0,u.rT)(e.data.namespace):[u.He]}function b(e,t,n,r,o){let i={$schema:"https://raw.githubusercontent.com/open-rmf/crossflow/refs/heads/main/diagram.schema.json",version:"0.1.0",templates:r,start:{builtin:"dispose"},ops:{}};for(let r of(y(e,t,i,n),Array.from(t.iterNodes()).sort((e,t)=>m(e).length-m(t).length))){if(!(0,s.on)(r))continue;let e=p(i,r.data.namespace);e.ops[r.data.opId]={...r.data.op},"scope"===r.data.op.type&&(e.ops[r.data.opId].ops={})}return i.description=o.description,i.input_examples=o.input_examples,i}function g(e,t,n){let r={start:{builtin:"dispose"},ops:{}},o={inputs:{},outputs:[],buffers:{},ops:r.ops};for(let i of(y(e,t,r,n),Array.from(t.iterNodes()).sort((e,t)=>m(e).length-m(t).length)))if((0,s.on)(i)){let e=p(r,i.data.namespace);e.ops[i.data.opId]={...i.data.op},"scope"===i.data.op.type&&(e.ops[i.data.opId].ops={})}else"sectionInput"===i.type?o.inputs[i.data.remappedId]=i.data.targetId:"sectionOutput"===i.type?o.outputs.push(i.data.outputId):"sectionBuffer"===i.type&&(o.buffers[i.data.remappedId]=i.data.targetId);return o}[d,s]=c.then?(await c)():c,r()}catch(e){r(e)}})},6713:function(e,t,n){n.d(t,{O:()=>r,e:()=>o});let r={nodeWidth:200,nodeHeight:50,scopePadding:{leftRight:75,topBottom:50}};function o(e){if(0===e.length)return{x:0,y:0,width:2*r.scopePadding.leftRight,height:2*r.scopePadding.topBottom};let t=Math.min(...e.map(e=>e.x)),n=Math.max(...e.map(e=>e.x+r.nodeWidth)),o=Math.min(...e.map(e=>e.y)),i=Math.max(...e.map(e=>e.y+r.nodeHeight));return{x:t-r.scopePadding.leftRight,y:o-r.scopePadding.topBottom,width:n-t+2*r.scopePadding.leftRight,height:i-o+2*r.scopePadding.topBottom}}},6066:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{$k:()=>b,DS:()=>y,yO:()=>h});var o=n(6113),i=n(2854),a=n(3943),s=n(6911),l=n(5354),u=n(5785),d=n(4187),c=n(1692),p=e([c,u,i,a]);async function f(e){let t=await (0,s.j)(e);return t?{graph:{nodes:t.nodes,edges:t.edges},isRestored:!0}:{graph:m(e),isRestored:!1}}async function h(e){let t=JSON.parse(e);if(!g(t)){var n;let e=null==(n=g.errors)?void 0:n[0];if(!e)throw"unknown error";throw`${e.instancePath} ${e.message}`}return[t,await f(t)]}function y(){return{nodes:[(0,a.mq)(d.He,{x:0,y:0}),(0,a.bO)(d.He,{x:0,y:400})],edges:[]}}function m(e,t){let n=t??y(),r=n.nodes,i=[...Object.entries(e.ops).map(e=>{let[t,n]=e;return{parentId:void 0,namespace:d.He,opId:t,op:n}})];for(let e=i.pop();void 0!==e;e=i.pop()){let{parentId:t,namespace:n,opId:o,op:s}=e;if("scope"===s.type){let e=(0,a.Ac)(n,t,{x:0,y:0},s,o),l=e[0].id;for(let[t,a]of(r.push(...e),Object.entries(s.ops)))i.push({parentId:l,namespace:(0,d.Tz)(n,o),opId:t,op:a})}else r.push((0,a.ou)(n,t,{x:0,y:0},s,o))}let s=n.edges,l=e.start,u=(0,c.i4)(l)?r.find(e=>e.type===l.builtin):r.find(e=>(0,a.on)(e)&&e.data.namespace===d.He&&e.data.opId===l);return u&&s.push((0,o.uh)((0,d.Tz)(d.He,a.M8),null,u.id,null)),s.push(...(0,c.WX)(n.nodes)),n}[c,u,i,a]=p.then?(await p)():p;let g=(0,l.J)("Diagram");function b(e){let t=(0,u.G)({messages:{},nodes:{},schemas:{},sections:{},trace_supported:!1},new i.Bl([]),[],{});t.ops=e.ops;let n=[];if(e.inputs)if(Array.isArray(e.inputs))for(let t of e.inputs)n.push((0,a.nJ)(t,t,{x:0,y:0}));else for(let[t,r]of Object.entries(e.inputs))n.push((0,a.nJ)(t,r,{x:0,y:0}));if(e.buffers)if(Array.isArray(e.buffers))for(let t of e.buffers)n.push((0,a.B0)(t,t,{x:0,y:0}));else for(let[t,r]of Object.entries(e.buffers))n.push((0,a.B0)(t,r,{x:0,y:0}));if(e.outputs)for(let t of e.outputs)n.push((0,a.kj)(t,{x:0,y:0}));return m(t,{nodes:n,edges:[]})}r()}catch(e){r(e)}})},4187:function(e,t,n){n.d(t,{He:()=>r,Tz:()=>o,rT:()=>i});let r="";function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join(":")}function i(e){return e.split(":")}},1692:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Il:()=>p,MK:()=>b,WX:()=>y,i4:()=>m,kY:()=>c});var o=n(6113),i=n(522),a=n(2854),s=n(3943),l=n(106),u=n(4187),d=e([a,s]);function c(e){return"string"!=typeof e&&!Array.isArray(e)}function p(e){return Array.isArray(e)}function f(e,t,n){let r=[];for(let[a,s]of Object.entries(e)){let e=n.getNodeFromNextOp(t.data.namespace,s);if(e){let n=e.id;r.push((0,o.Io)(t.id,i.vH.DataStream,n,null,{streamId:a}))}}return r}function h(e,t){return"join"!==e.type||"join"!==e.data.op.type?null:e.data.op.clone&&t in e.data.op.clone?o.fe.Clone:o.fe.Pull}function y(e){let t=[],n=new a.Bl(e),r=[...e.map(e=>({namespace:u.He,opId:e.data.opId,op:e.data.op}))];for(let a of e){var d,y,m,b,g,x,_,j,w,v,k,Z,O;if((0,s.on)(a)){let e=a.data.op,O=a.data.opId;switch(e.type){case"buffer":case"stream_out":break;case"buffer_access":case"join":case"listen":{t.push(...function(e,t,n){var r,i;let a=[];if(p(t))for(let[i,s]of t.entries()){let t=null==(r=n.getNodeFromNextOp(e.data.namespace,s))?void 0:r.id;if(t){let n=h(e,i);a.push((0,o.XE)(t,null,e.id,null,{type:"bufferSeq",seq:i,...null!==n?{fetchType:n}:{}}))}}else if(c(t))for(let[r,s]of Object.entries(t)){let t=null==(i=n.getNodeFromNextOp(e.data.namespace,s))?void 0:i.id;if(t){let n=h(e,r);a.push((0,o.XE)(t,null,e.id,null,{type:"bufferKey",key:r,...null!==n?{fetchType:n}:{}}))}}return a}(a,e.buffers,n));let r=null==(d=n.getNodeFromNextOp(a.data.namespace,e.next))?void 0:d.id;r&&t.push((0,o.uh)(a.id,null,r,null));break}case"node":{let r=null==(y=n.getNodeFromNextOp(a.data.namespace,e.next))?void 0:y.id;r&&t.push((0,o.uh)(a.id,null,r,null)),e.stream_out&&t.push(...f(e.stream_out,a,n));break}case"transform":{let r=null==(m=n.getNodeFromNextOp(a.data.namespace,e.next))?void 0:m.id;r&&t.push((0,o.uh)(a.id,null,r,null));break}case"fork_clone":for(let r of e.next.values()){let e=null==(b=n.getNodeFromNextOp(a.data.namespace,r))?void 0:b.id;e&&t.push((0,o.uh)(a.id,null,e,null))}break;case"unzip":for(let[r,i]of e.next.entries()){let e=null==(g=n.getNodeFromNextOp(a.data.namespace,i))?void 0:g.id;e&&t.push((0,o.qj)(a.id,null,e,null,{seq:r}))}break;case"fork_result":{let r=null==(x=n.getNodeFromNextOp(a.data.namespace,e.ok))?void 0:x.id,s=null==(_=n.getNodeFromNextOp(a.data.namespace,e.err))?void 0:_.id;r&&t.push((0,o.j1)(a.id,i.vH.ForkResultOk,r,null)),s&&t.push((0,o.gw)(a.id,i.vH.ForkResultErr,s,null));break}case"split":if(e.keyed)for(let[r,i]of Object.entries(e.keyed)){let e=null==(j=n.getNodeFromNextOp(a.data.namespace,i))?void 0:j.id;e&&t.push((0,o.zk)(a.id,null,e,null,{key:r}))}if(e.sequential)for(let[r,i]of e.sequential.entries()){let e=null==(w=n.getNodeFromNextOp(a.data.namespace,i))?void 0:w.id;e&&t.push((0,o._w)(a.id,null,e,null,{seq:r}))}if(e.remaining){let r=null==(v=n.getNodeFromNextOp(a.data.namespace,e.remaining))?void 0:v.id;r&&t.push((0,o.sN)(a.id,null,r,null))}break;case"section":if(e.connect)for(let[r,i]of Object.entries(e.connect)){let e=null==(k=n.getNodeFromNextOp(a.data.namespace,i))?void 0:k.id;e&&t.push((0,o.F9)(a.id,null,e,null,{output:r}))}break;case"scope":{let i=null==(Z=n.getNodeFromNextOp(a.data.namespace,e.next))?void 0:Z.id;i&&t.push((0,o.uh)(a.id,null,i,null)),e.stream_out&&t.push(...f(e.stream_out,a,n));let l=n.getNodeFromNamespaceOpId((0,u.Tz)(a.data.namespace,O),s.M8),d=n.getNodeFromNextOp((0,u.Tz)(a.data.namespace,O),e.start);for(let[n,i]of(l&&d&&t.push((0,o.uh)(l.id,null,d.id,null)),Object.entries(e.ops)))r.push({namespace:(0,u.Tz)(a.data.namespace,O),opId:n,op:i});break}default:throw(0,l.y)(e),Error("unknown op")}}else if("sectionInput"===a.type||"sectionBuffer"===a.type){let e=null==(O=n.getNodeFromNextOp(u.He,a.data.targetId))?void 0:O.id;e&&t.push((0,o.uh)(a.id,null,e,null))}}return t}function m(e){return null!==e&&"object"==typeof e&&"builtin"in e}function b(e){return"builder"in e}[a,s]=d.then?(await d)():d,r()}catch(e){r(e)}})},6500:function(e,t,n){n.d(t,{H:()=>r});function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_",r=new Set(t);if(!r.has(e))return e;for(let o=1;o<t.length;++o){let t=`${e}${n}${o}`;if(!r.has(t))return t}return`${e}${n}${t.length+1}`}},3152:function(e,t,n){n.a(e,async function(e,r){try{n.d(t,{Ff:()=>i.Ff,ad:()=>i.ad,hv:()=>i.hv,wc:()=>i.wc});var o=n(7121),i=n(3564),a=e([o]);o=(a.then?(await a)():a)[0],(0,i.oT)(o),o.__wbindgen_start(),r()}catch(e){r(e)}})},3564:function(e,t,n){let r;function o(e){r=e}function i(e){let t=r.__externref_table_alloc();return r.__wbindgen_externrefs.set(t,e),t}n.d(t,{AN:()=>eO,B7:()=>ew,B9:()=>I,BB:()=>ei,Br:()=>ev,Co:()=>A,Ff:()=>w,Fu:()=>Y,I7:()=>es,J2:()=>eb,Jf:()=>P,L9:()=>en,Ld:()=>el,N7:()=>ed,O1:()=>Q,OB:()=>eI,OZ:()=>em,QM:()=>ej,Qc:()=>e$,R$:()=>eh,S5:()=>ex,SX:()=>eu,SZ:()=>X,T3:()=>B,TZ:()=>q,UL:()=>ek,V6:()=>G,VR:()=>O,WE:()=>C,Wn:()=>R,Wr:()=>ec,XX:()=>eZ,Xe:()=>S,Xx:()=>Z,YJ:()=>T,ZD:()=>er,_F:()=>N,ad:()=>k,cB:()=>eo,cr:()=>M,cs:()=>eq,dY:()=>H,eM:()=>eS,f3:()=>D,gI:()=>J,hA:()=>eN,he:()=>V,hv:()=>j,iZ:()=>eT,jU:()=>eg,kG:()=>ep,lO:()=>ey,lU:()=>ef,mq:()=>z,oT:()=>o,qF:()=>W,qU:()=>e_,qn:()=>eC,rq:()=>ee,sK:()=>ea,sY:()=>L,t3:()=>F,un:()=>U,vV:()=>$,vw:()=>K,wc:()=>v,x7:()=>E,xQ:()=>eE,xY:()=>et});let a="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>e.dtor(e.a,e.b)),s=null;function l(){return(null===s||!0===s.buffer.detached||void 0===s.buffer.detached&&s.buffer!==r.memory.buffer)&&(s=new DataView(r.memory.buffer)),s}function u(e,t){var n,r;return n=e>>>=0,(m+=r=t)>=0x7ff00000&&((y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0})).decode(),m=r),y.decode(c().subarray(n,n+r))}let d=null;function c(){return(null===d||0===d.byteLength)&&(d=new Uint8Array(r.memory.buffer)),d}function p(e,t){try{return e.apply(this,t)}catch(t){let e=i(t);r.__wbindgen_exn_store(e)}}function f(e){return null==e}function h(e,t,n){if(void 0===n){let n=b.encode(e),r=t(n.length,1)>>>0;return c().subarray(r,r+n.length).set(n),g=n.length,r}let r=e.length,o=t(r,1)>>>0,i=c(),a=0;for(;a<r;a++){let t=e.charCodeAt(a);if(t>127)break;i[o+a]=t}if(a!==r){0!==a&&(e=e.slice(a)),o=n(o,r,r=a+3*e.length,1)>>>0;let t=c().subarray(o+a,o+r);a+=b.encodeInto(e,t).written,o=n(o,r,a,1)>>>0}return g=a,o}let y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});y.decode();let m=0,b=new TextEncoder;"encodeInto"in b||(b.encodeInto=function(e,t){let n=b.encode(e);return t.set(n),{read:e.length,written:n.length}});let g=0;function x(e,t,n){r.wasm_bindgen__convert__closures_____invoke__h0d1d12d5fe225def(e,t,n)}let _="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>r.__wbg_postrunrequestwasm_free(e>>>0,1));class j{__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,_.unregister(this),e}free(){let e=this.__destroy_into_raw();r.__wbg_postrunrequestwasm_free(e,0)}constructor(e){let t=r.postrunrequestwasm_new(e);return this.__wbg_ptr=t>>>0,_.register(this,this.__wbg_ptr,this),this}}function w(){return r.get_registry()}function v(){r.init_wasm()}function k(e){if(!(e instanceof j))throw Error(`expected instance of ${j.name}`);var t=e.__destroy_into_raw();return r.post_run(t)}function Z(e,t){return Error(u(e,t))}function O(e,t){let n="bigint"==typeof t?t:void 0;l().setBigInt64(e+8,f(n)?BigInt(0):n,!0),l().setInt32(e+0,!f(n),!0)}function C(e){let t="boolean"==typeof e?e:void 0;return f(t)?0xffffff:+!!t}function S(e,t){let n=h(function e(t){let n,r=typeof t;if("number"==r||"boolean"==r||null==t)return`${t}`;if("string"==r)return`"${t}"`;if("symbol"==r){let e=t.description;return null==e?"Symbol":`Symbol(${e})`}if("function"==r){let e=t.name;return"string"==typeof e&&e.length>0?`Function(${e})`:"Function"}if(Array.isArray(t)){let n=t.length,r="[";n>0&&(r+=e(t[0]));for(let o=1;o<n;o++)r+=", "+e(t[o]);return r+"]"}let o=/\[object ([^\]]+)\]/.exec(toString.call(t));if(!o||!(o.length>1))return toString.call(t);if("Object"==(n=o[1]))try{return"Object("+JSON.stringify(t)+")"}catch(e){return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:n}(t),r.__wbindgen_malloc,r.__wbindgen_realloc),o=g;l().setInt32(e+4,o,!0),l().setInt32(e+0,n,!0)}function I(e,t){return e in t}function $(e){return"bigint"==typeof e}function N(e){return"function"==typeof e}function T(e){return"object"==typeof e&&null!==e}function q(e){return"string"==typeof e}function E(e){return void 0===e}function D(e,t){return e===t}function B(e,t){return e==t}function P(e,t){let n="number"==typeof t?t:void 0;l().setFloat64(e+8,f(n)?0:n,!0),l().setInt32(e+0,!f(n),!0)}function z(e,t){let n="string"==typeof t?t:void 0;var o=f(n)?0:h(n,r.__wbindgen_malloc,r.__wbindgen_realloc),i=g;l().setInt32(e+4,i,!0),l().setInt32(e+0,o,!0)}function R(e,t){throw Error(u(e,t))}function H(e){e._wbg_cb_unref()}function F(){return p(function(e,t,n){return e.call(t,n)},arguments)}function M(){return p(function(e,t){return e.call(t)},arguments)}function A(e,t,n,r){console.debug(e,t,n,r)}function L(e){return e.done}function W(e){return Object.entries(e)}function K(e){console.error(e)}function J(e,t,n,r){console.error(e,t,n,r)}function G(e,t){return e[t>>>0]}function U(){return p(function(e,t){return Reflect.get(e,t)},arguments)}function X(e,t){return e[t]}function V(e,t,n,r){console.info(e,t,n,r)}function Y(e){let t;try{t=e instanceof ArrayBuffer}catch(e){t=!1}return t}function Q(e){let t;try{t=e instanceof Map}catch(e){t=!1}return t}function ee(e){let t;try{t=e instanceof Uint8Array}catch(e){t=!1}return t}function et(e){return Array.isArray(e)}function en(e){return Number.isSafeInteger(e)}function er(){return Symbol.iterator}function eo(e){return e.length}function ei(e){return e.length}function ea(e,t,n,r){console.log(e,t,n,r)}function es(){return{}}function el(){return[]}function eu(e){return new Uint8Array(e)}function ed(){return new Map}function ec(e,t){try{var n={a:e,b:t};return new Promise((e,t)=>{let o=n.a;n.a=0;try{var i;return i=n.b,void r.wasm_bindgen__convert__closures_____invoke__hb1defd68b6c83b52(o,i,e,t)}finally{n.a=o}})}finally{n.a=n.b=0}}function ep(e,t){return Function(u(e,t))}function ef(e){return e.next}function eh(){return p(function(e){return e.next()},arguments)}function ey(e,t,n){var r;Uint8Array.prototype.set.call((r=e>>>0,c().subarray(r/1,r/1+t)),n)}function em(e){return e.queueMicrotask}function eb(e){queueMicrotask(e)}function eg(e){return Promise.resolve(e)}function ex(e,t,n){e[t]=n}function e_(e,t,n){e[t>>>0]=n}function ej(e,t,n){return e.set(t,n)}function ew(){let e="undefined"==typeof global?null:global;return f(e)?0:i(e)}function ev(){let e="undefined"==typeof globalThis?null:globalThis;return f(e)?0:i(e)}function ek(){let e="undefined"==typeof self?null:self;return f(e)?0:i(e)}function eZ(){let e="undefined"==typeof window?null:window;return f(e)?0:i(e)}function eO(e,t){return e.then(t)}function eC(e){return e.value}function eS(e,t,n,r){console.warn(e,t,n,r)}function eI(e,t){return u(e,t)}function e$(e){return BigInt.asUintN(64,e)}function eN(e){return e}function eT(e){return e}function eq(e,t){var n=e,o=t,i=r.wasm_bindgen__closure__destroy__hcf25b47c73b22808,s=x;let l={a:n,b:o,cnt:1,dtor:i},u=(...e)=>{l.cnt++;let t=l.a;l.a=0;try{return s(t,l.b,...e)}finally{l.a=t,u._wbg_cb_unref()}};return u._wbg_cb_unref=()=>{0==--l.cnt&&(l.dtor(l.a,l.b),l.a=0,a.unregister(l))},a.register(u,l,l),u}function eE(){let e=r.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)}Symbol.dispose&&(j.prototype[Symbol.dispose]=j.prototype.free)},7121:function(e,t,n){var r=n(3564);e.exports=n.v(t,e.id,"32de84f60b1f6b6d",{"./calculator_wasm_bg.js":{__wbg_debug_9ad80675faf0c9cf:r.Co,__wbg_error_7bc7d576a6aaf855:r.vw,__wbg_error_ad1ecdacd1bb600d:r.gI,__wbg_info_b7fa8ce2e59d29c6:r.he,__wbg_log_f614673762e98966:r.sK,__wbg_warn_165ef4f6bcfc05e7:r.eM,__wbg_queueMicrotask_fca69f5bfad613a5:r.J2,__wbg_queueMicrotask_9b549dfce8865860:r.OZ,__wbg_get_with_ref_key_1dc361bd10053bfe:r.SZ,__wbg_set_3f1d0b984ed272ed:r.S5,__wbg_get_6b7bd52aca3f9671:r.V6,__wbg_length_d45040a40c570362:r.BB,__wbg_new_25f239778d6112b9:r.Ld,__wbg_new_no_args_cb138f77cf6151ee:r.kG,__wbg_new_b546ae120718850e:r.N7,__wbg_next_138a17bbf04e926c:r.lU,__wbg_next_3cfe5c0fe2a4cc53:r.R$,__wbg_done_62ea16af4ce34b24:r.sY,__wbg_value_57b7b035e117f7ee:r.qn,__wbg_iterator_27b7c8b35ab3e86b:r.ZD,__wbg_get_af9dab7e9603ea93:r.un,__wbg_call_abb4ff46ce38be40:r.cr,__wbg_new_1ba21ce319a06297:r.I7,__wbg_set_7df433eea03a5c14:r.qU,__wbg_isArray_51fd9e6422c0a395:r.xY,__wbg_instanceof_ArrayBuffer_f3320d2419cd0355:r.Fu,__wbg_call_3020136f7a2d6e44:r.t3,__wbg_instanceof_Map_084be8da74364158:r.O1,__wbg_set_efaaf145b9377369:r.QM,__wbg_isSafeInteger_ae7d3f054d55fa16:r.L9,__wbg_entries_83c79938054e065f:r.qF,__wbg_new_ff12d2b041fb48f1:r.Wr,__wbg_resolve_fd5bfbaa4ce36e1e:r.jU,__wbg_then_4f95312d68691235:r.AN,__wbg_static_accessor_GLOBAL_THIS_60cf02db4de8e1c1:r.Br,__wbg_static_accessor_SELF_08f5a74c69739274:r.UL,__wbg_static_accessor_WINDOW_a8924b26aa92d024:r.XX,__wbg_static_accessor_GLOBAL_769e6b65d6557335:r.B7,__wbg_length_22ac23eaec9d8053:r.cB,__wbg_prototypesetcall_dfe9b766cdc1f1fd:r.lO,__wbg_new_6421f6084cc5bc5a:r.SX,__wbg_instanceof_Uint8Array_da54ccc9d3e09434:r.rq,__wbg___wbindgen_string_get_a2a31e16edf96e42:r.mq,__wbg__wbg_cb_unref_87dfb5aaa0cbcea7:r.dY,__wbg___wbindgen_boolean_get_dea25b33882b895b:r.WE,__wbg___wbindgen_number_get_9619185a74197f95:r.Jf,__wbg___wbindgen_is_undefined_f6b95eab589e0269:r.x7,__wbg___wbindgen_debug_string_adfb662ae34724b6:r.Xe,__wbg___wbindgen_bigint_get_as_i64_6e32f5e6aff02e1d:r.VR,__wbg___wbindgen_jsval_eq_b6101cc9cef1fe36:r.f3,__wbg_Error_52673b7de5a0ca89:r.Xx,__wbg___wbindgen_is_object_ce774f3490692386:r.YJ,__wbg___wbindgen_is_function_8d400b8b1af978cd:r._F,__wbg___wbindgen_is_string_704ef9c8fc131030:r.TZ,__wbg___wbindgen_is_bigint_0e1a2e3f55cfae27:r.vV,__wbg___wbindgen_in_0d3e1e8f0c669317:r.B9,__wbg___wbindgen_throw_dd24417ed36fc46e:r.Wn,__wbg___wbindgen_jsval_loose_eq_766057600fdd1b0d:r.T3,__wbindgen_init_externref_table:r.xQ,__wbindgen_cast_d6cd19b81560fd6e:r.iZ,__wbindgen_cast_9ae0607507abb057:r.hA,__wbindgen_cast_4625c577ab2ec9ee:r.Qc,__wbindgen_cast_2241b6af4c4b2941:r.OB,__wbindgen_cast_e053625c6cf50240:r.cs}})}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,(()=>{var e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",o=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},i=n=>n.map(n=>{if(null!==n&&"object"==typeof n){if(n[e])return n;if(n.then){var i=[];i.d=0,n.then(e=>{a[t]=e,o(i)},e=>{a[r]=e,o(i)});var a={};return a[e]=e=>e(i),a}}var s={};return s[e]=function(){},s[t]=n,s});n.a=(n,a,s)=>{s&&((l=[]).d=-1);var l,u,d,c,p=new Set,f=n.exports,h=new Promise((e,t)=>{c=t,d=e});h[t]=f,h[e]=e=>{l&&e(l),p.forEach(e),h.catch(function(){})},n.exports=h,a(n=>{u=i(n);var o,a=()=>u.map(e=>{if(e[r])throw e[r];return e[t]}),s=new Promise(t=>{(o=()=>t(a)).r=0;var n=e=>e!==l&&!p.has(e)&&(p.add(e),e&&!e.d&&(o.r++,e.push(o)));u.map(t=>t[e](n))});return o.r?s:a()},e=>(e?c(h[r]=e):d(f),o(l))),l&&l.d<0&&(l.d=0)}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o||"object"==typeof r&&r&&(4&o&&r.__esModule||16&o&&"function"==typeof r.then))return r;var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>{a[e]=()=>r[e]});return a.default=()=>r,n.d(i,a),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=[];n.O=(t,r,o,i)=>{if(r){i=i||0;for(var a=e.length;a>0&&e[a-1][2]>i;a--)e[a]=e[a-1];e[a]=[r,o,i];return}for(var s=1/0,a=0;a<e.length;a++){for(var[r,o,i]=e[a],l=!0,u=0;u<r.length;u++)(!1&i||s>=i)&&Object.keys(n.O).every(e=>n.O[e](r[u]))?r.splice(u--,1):(l=!1,i<s&&(s=i));if(l){e.splice(a--,1);var d=o();void 0!==d&&(t=d)}}return t}})(),n.p="/crossflow/",n.rv=()=>"1.3.11",n.v=function(e,t,r,o){var i=fetch(n.p+"static/wasm/"+r+".module.wasm"),a=function(){return i.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,o)}).then(function(t){return Object.assign(e,t.instance.exports)})};return i.then(function(t){return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(t,o).then(function(t){return Object.assign(e,t.instance.exports)},function(e){if("application/wasm"!==t.headers.get("Content-Type"))return console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e),a();throw e}):a()})},(()=>{var e={980:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,i,[a,s,l]=r,u=0;if(a.some(t=>0!==e[t])){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)var d=l(n)}for(t&&t(r);u<a.length;u++)i=a[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},r=self.webpackChunkdiagram_editor=self.webpackChunkdiagram_editor||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n.ruid="bundler=rspack@1.3.11";var r=n.O(void 0,["361","867"],function(){return n(6717)});r=n.O(r)})();